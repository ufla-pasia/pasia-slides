<!DOCTYPE html>
<html lang="pt-BR"><head>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-html/tabby.min.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/light-border.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-59898bd1c6b9d2bb783127feaa000c76.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/quarto-contrib/jquery-3.6.3/jquery-3.6.3.min.js"></script>
<script src="site_libs/quarto-contrib/code-fullscreen-1.0.0/code-fullscreen.js" defer="true"></script>
<link href="site_libs/quarto-contrib/code-fullscreen-1.0.0/code-fullscreen.css" rel="stylesheet">
<script src="site_libs/quarto-contrib/roughnotation-0.5.1/rough-notation.iife.js"></script>
<script src="site_libs/quarto-contrib/roughnotation-init-1.0.0/rough.js"></script><meta charset="utf-8">
  <meta name="generator" content="quarto-1.7.33">

  <meta name="author" content="Prof.&nbsp;Julio César Alves">
  <title>GAC126 - Programação Aplicada com Suporte de IA – Automatizando Tarefas Tediosas</title>
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui">
  <link rel="stylesheet" href="site_libs/revealjs/dist/reset.css">
  <link rel="stylesheet" href="site_libs/revealjs/dist/reveal.css">
  <style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      width: 0.8em;
      margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
      vertical-align: middle;
    }
    /* CSS for syntax highlighting */
    html { -webkit-text-size-adjust: 100%; }
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    .sourceCode { overflow: visible; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
      }
    pre.numberSource { margin-left: 3em;  padding-left: 4px; }
    div.sourceCode
      { color: #24292e;  }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span { color: #24292e; } /* Normal */
    code span.al { color: #ff5555; font-weight: bold; } /* Alert */
    code span.an { color: #6a737d; } /* Annotation */
    code span.at { color: #d73a49; } /* Attribute */
    code span.bn { color: #005cc5; } /* BaseN */
    code span.bu { color: #d73a49; } /* BuiltIn */
    code span.cf { color: #d73a49; } /* ControlFlow */
    code span.ch { color: #032f62; } /* Char */
    code span.cn { color: #005cc5; } /* Constant */
    code span.co { color: #6a737d; } /* Comment */
    code span.cv { color: #6a737d; } /* CommentVar */
    code span.do { color: #6a737d; } /* Documentation */
    code span.dt { color: #d73a49; } /* DataType */
    code span.dv { color: #005cc5; } /* DecVal */
    code span.er { color: #ff5555; text-decoration: underline; } /* Error */
    code span.ex { color: #d73a49; font-weight: bold; } /* Extension */
    code span.fl { color: #005cc5; } /* Float */
    code span.fu { color: #6f42c1; } /* Function */
    code span.im { color: #032f62; } /* Import */
    code span.in { color: #6a737d; } /* Information */
    code span.kw { color: #d73a49; } /* Keyword */
    code span.op { color: #24292e; } /* Operator */
    code span.ot { color: #6f42c1; } /* Other */
    code span.pp { color: #d73a49; } /* Preprocessor */
    code span.re { color: #6a737d; } /* RegionMarker */
    code span.sc { color: #005cc5; } /* SpecialChar */
    code span.ss { color: #032f62; } /* SpecialString */
    code span.st { color: #032f62; } /* String */
    code span.va { color: #e36209; } /* Variable */
    code span.vs { color: #032f62; } /* VerbatimString */
    code span.wa { color: #ff5555; } /* Warning */
  </style>
  <link rel="stylesheet" href="site_libs/revealjs/dist/theme/quarto-7280ab350550966646cc056a90a36f14.css">
  <link href="site_libs/revealjs/plugin/quarto-line-highlight/line-highlight.css" rel="stylesheet">
  <link href="site_libs/revealjs/plugin/reveal-menu/menu.css" rel="stylesheet">
  <link href="site_libs/revealjs/plugin/reveal-menu/quarto-menu.css" rel="stylesheet">
  <link href="site_libs/revealjs/plugin/reveal-chalkboard/font-awesome/css/all.css" rel="stylesheet">
  <link href="site_libs/revealjs/plugin/reveal-chalkboard/style.css" rel="stylesheet">
  <link href="site_libs/revealjs/plugin/reveal-pointer/pointer.css" rel="stylesheet">
  <link href="site_libs/revealjs/plugin/quarto-support/footer.css" rel="stylesheet">
  <style type="text/css">
    .reveal div.sourceCode {
      margin: 0;
      overflow: auto;
    }
    .reveal div.hanging-indent {
      margin-left: 1em;
      text-indent: -1em;
    }
    .reveal .slide:not(.center) {
      height: 100%;
    }
    .reveal .slide.scrollable {
      overflow-y: auto;
    }
    .reveal .footnotes {
      height: 100%;
      overflow-y: auto;
    }
    .reveal .slide .absolute {
      position: absolute;
      display: block;
    }
    .reveal .footnotes ol {
      counter-reset: ol;
      list-style-type: none; 
      margin-left: 0;
    }
    .reveal .footnotes ol li:before {
      counter-increment: ol;
      content: counter(ol) ". "; 
    }
    .reveal .footnotes ol li > p:first-child {
      display: inline-block;
    }
    .reveal .slide ul,
    .reveal .slide ol {
      margin-bottom: 0.5em;
    }
    .reveal .slide ul li,
    .reveal .slide ol li {
      margin-top: 0.4em;
      margin-bottom: 0.2em;
    }
    .reveal .slide ul[role="tablist"] li {
      margin-bottom: 0;
    }
    .reveal .slide ul li > *:first-child,
    .reveal .slide ol li > *:first-child {
      margin-block-start: 0;
    }
    .reveal .slide ul li > *:last-child,
    .reveal .slide ol li > *:last-child {
      margin-block-end: 0;
    }
    .reveal .slide .columns:nth-child(3) {
      margin-block-start: 0.8em;
    }
    .reveal blockquote {
      box-shadow: none;
    }
    .reveal .tippy-content>* {
      margin-top: 0.2em;
      margin-bottom: 0.7em;
    }
    .reveal .tippy-content>*:last-child {
      margin-bottom: 0.2em;
    }
    .reveal .slide > img.stretch.quarto-figure-center,
    .reveal .slide > img.r-stretch.quarto-figure-center {
      display: block;
      margin-left: auto;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-left,
    .reveal .slide > img.r-stretch.quarto-figure-left  {
      display: block;
      margin-left: 0;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-right,
    .reveal .slide > img.r-stretch.quarto-figure-right  {
      display: block;
      margin-left: auto;
      margin-right: 0; 
    }
  </style>
</head>
<body class="quarto-light">
  <div class="reveal">
    <div class="slides">

<section id="title-slide" class="quarto-title-block center">
  <h1 class="title">Automatizando Tarefas Tediosas</h1>
  <p class="subtitle">PASIA - Aula T.6</p>

<div class="quarto-title-authors">
<div class="quarto-title-author">
<div class="quarto-title-author-name">
<a href="https://julio.dac.ufla.br">Prof.&nbsp;Julio César Alves</a> 
</div>
        <p class="quarto-title-affiliation">
            DAC - ICET - Universidade Federal de Lavras
          </p>
    </div>
</div>

  <p class="date">13/09/2025</p>
</section>
<section id="section" class="slide level2">
<h2></h2>
<p>O conteúdo dessa aula é baseado no <strong>capítulo 9</strong> do livro abaixo.</p>
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="imagens/livro_potter_zingaro.png" class="quarto-figure quarto-figure-center" style="max-height: 50vh; width: auto;" alt="Capa do livro de Potter e Zingaro."></p>
</figure>
</div>
</section>
<section>
<section id="introdução" class="title-slide slide level1 center" data-background-color="#40666e">
<h1>Introdução</h1>

</section>
<section id="section-1" class="slide level2">
<h2></h2>
<p>Suponha que você seja responsável por criar 100 relatórios, cada um para uma pessoa diferente.</p>
<ul>
<li class="fragment">Poderia ser um professor que precisa enviar correções para seus estudantes.</li>
<li class="fragment">Ou alguém em um departamento de RH que precisa enviar a avaliação anual para cada funcionário.</li>
</ul>
<div class="fragment">
<p>Suponha que você tenha decidido preparar os relatórios em arquivos PDF.</p>
<ul>
<li class="fragment">E que você precisa de uma capa para os arquivos que é customizada para cada pessoa.</li>
<li class="fragment">Seu colega, designer gráfico, preparou essas capas para você.</li>
</ul>
</div>
</section>
<section id="section-2" class="slide level2">
<h2></h2>
<p>Você e seu colega trabalharam de forma independente e agora cada um terminou sua tarefa.</p>
<ul>
<li class="fragment">Quer dizer, quase, pois agora é necessário juntar as capas com os relatórios.</li>
</ul>
<div class="fragment">
<p>Alguém que não é programador estaria agora <em>“rangendo os dentes”</em></p>
<ul>
<li class="fragment">com o trabalho manual de juntar cada capa com cada relatório.</li>
<li class="fragment">Isso poderia levar horas!</li>
</ul>
</div>
</section>
<section id="section-3" class="slide level2">
<h2></h2>
<p>Mas nós somos <span class="alert">programadores</span>!</p>
<ul>
<li class="fragment">E programadores nunca fariam um trabalho desse manualmente!</li>
<li class="fragment">Ou pelo menos não deveriam.</li>
</ul>
<div class="fragment">
<div class="callout callout-tip callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>Dica</strong></p>
</div>
<div class="callout-content">
<p>Muitas vezes seguimos o ditado: <em>Casa de ferreiro, espeto de pau.</em></p>
<p>E perdemos tempo com tarefas que poderiam ser otimizadas.</p>
</div>
</div>
</div>
</div>
</section>
<section id="section-4" class="slide level2">
<h2></h2>
<p>Nessa aula vamos ver como escrever programas que automatizam tarefas tediosas.</p>
<ul>
<li class="fragment">Uma das tarefas será essa dos PDFs.</li>
<li class="fragment">Mas também veremos outras tipos de tarefas manuais com as quais podemos ganhar tempo automatizando-as.</li>
</ul>
</section></section>
<section>
<section id="por-que-programadores-criam-ferramentas" class="title-slide slide level1 center" data-background-color="#40666e">
<h1>Por que programadores criam ferramentas?</h1>

</section>
<section id="section-5" class="slide level2">
<h2></h2>
<p>Muitas vezes os programadores se definem como <em>preguiçosos</em>.</p>
<ul>
<li class="fragment">Não no sentido de que não queremos fazer nosso trabalho.</li>
<li class="fragment">Mas sim, que não queremos fazer tarefas que são <strong>repetitivas</strong>, <strong>chatas</strong>, <strong>tediosas</strong> 😒.
<ul>
<li class="fragment">Tipos de tarefas que os computadores são muito melhores que nós.</li>
</ul></li>
</ul>
<div class="fragment">
<p>Bons programadores costumam ter um 🕷️ <em>“sentido aranha”</em> 🕸️ para identificar tarefas penosas.</p>
</div>
</section>
<section id="section-6" class="slide level2">
<h2></h2>
<p>Suponha, por exemplo, que tenhamos centenas de fotos que juntamos de uma viagem. 🖼️</p>
<ul>
<li class="fragment">E queremos remover as fotos duplicadas.</li>
<li class="fragment">E, claro, não queremos ter o trabalho de verificar uma por uma, pois isso levaria muito tempo.</li>
</ul>
<div class="fragment">
<p>Ou suponha que um professor tenha que enviar um e-mail com notas para cada um de seus estudantes.</p>
<ul>
<li class="fragment">Se forem poucos alunos ele pode escrever um e-mail para cada um.</li>
<li class="fragment">Mas se forem muitos, nenhum professor vair querer fazer isso manualmente.</li>
</ul>
</div>
</section>
<section id="section-7" class="slide level2">
<h2></h2>
<p>Sempre que um <strong>bom programador</strong> se depara com uma tarefa com passos repetitivos</p>
<ul>
<li class="fragment">ele pensa em como construir uma <span class="alert">ferramenta</span> para automatizá-la.</li>
</ul>
<div class="fragment">
<p>O termo <strong>ferramenta</strong> está sendo usado aqui no sentido de programas que fazem algo que nos poupe tempo.</p>
<ul>
<li class="fragment">Muitas vezes a ferramenta em si não é o objetivo final.</li>
<li class="fragment">E criar a ferramenta pode também ser meio entendiante.</li>
<li class="fragment">Mas uma vez que ela está pronta, ela pode nos poupar muito tempo.</li>
</ul>
</div>
</section>
<section id="section-8" class="slide level2">
<h2></h2>
<p>Às vezes criamos uma ferramenta para usar uma única vez.</p>
<ul>
<li class="fragment">Mas, na maioria das vezes, essas ferramentas acabam se tornando úteis novamente no futuro.
<ul>
<li class="fragment">Seja do jeito que ela foi construída inicialmente,</li>
<li class="fragment">ou com algumas melhorias.</li>
</ul></li>
</ul>
</section>
<section id="section-9" class="slide level2">
<h2></h2>
<p>Eu, Julio, por exemplo, envio um e-mail com feedback individual para os alunos após as correções das provas das disciplinas que leciono.</p>
<ul>
<li class="fragment">Seria inviável fazer isso manualmente.</li>
</ul>
<div class="fragment">
<p>Eu faço a correção da prova em uma panilha do Google.</p>
<ul>
<li class="fragment">E escrevi um script (<em>Apps Script</em>) que lê a planilha e envia o e-mail para cada aluno.</li>
<li class="fragment">Deu um trabalho inicialmente, e de vez em quando preciso fazer ajustes.</li>
<li class="fragment">Mas no final das contas, o tempo que economizo é enorme.</li>
</ul>
</div>
</section>
<section id="section-10" class="slide level2">
<h2></h2>
<p>E agora que temos Assistentes de IA, como o Copilot,</p>
<ul>
<li class="fragment">ficou ainda mais fácil criarmos ferramentas para tarefas repetitivas.</li>
</ul>
<div class="fragment">
<p>Não faz sentido um programador não usar essas ferramentas para se ajudar.</p>
<ul>
<li class="fragment">nem no sentido pessoal (podemos usar o tempo que economizamos para coisas mais prazerosas).</li>
<li class="fragment">nem no sentido profissional (podemos aumentar nossa produtividade).</li>
</ul>
</div>
</section></section>
<section>
<section id="como-usar-o-copilot-para-criar-ferramentas" class="title-slide slide level1 center" data-background-color="#40666e">
<h1>Como usar o Copilot para criar ferramentas</h1>

</section>
<section id="section-11" class="slide level2">
<h2></h2>
<p>Muitas vezes precisamos usar <span class="alert">módulos</span> (<strong>bibliotecas</strong>) do Python para realizar alguma tarefa que precisamos.</p>
<ul>
<li class="fragment">Pode ser que seja uma biblioteca incluída (<strong><em>built-in</em></strong>) do Python.
<ul>
<li class="fragment">Ex.: <code>csv</code>, <code>json</code>, <code>zipfile</code>, etc.</li>
</ul></li>
<li class="fragment">Ou uma biblioteca que precisamos <strong>instalar</strong> antes de usar.</li>
</ul>
</section>
<section id="section-12" class="slide level2">
<h2></h2>
<p>Quando estamos criando ferramentas, é muito comum que:</p>
<ul>
<li class="fragment">precisemos lidar com arquivos de diferentes formato
<ul>
<li class="fragment">(como arquivos zip, pdf, planilhas de excel ou imagens).</li>
</ul></li>
<li class="fragment">e que precisemos fazer alguma tarefa específica
<ul>
<li class="fragment">(como enviar e-mails, intergair com um site, mover arquivos, etc).</li>
</ul></li>
</ul>
<div class="fragment">
<p>Para muitas dessas coisas precisaremos usar algum módulo.</p>
<ul>
<li class="fragment">Mas qual módulo?</li>
<li class="fragment">E ele é <em>built-in</em> ou preciso instalar?</li>
</ul>
</div>
</section>
<section id="section-13" class="slide level2">
<h2></h2>
<p>Assistentes de IA, como o Copilot, podem nos ajudar a começar.</p>
<ul>
<li class="fragment">A ideia é conversarmos com o assistente de IA para descobrir qual módulo precisamos usar.</li>
<li class="fragment">E só depois disso entramos na etapa de criar a ferramenta propriamente dita.</li>
</ul>
<div class="fragment">
<p>Na criação da ferramenta, podemos seguir os passos que vimos anteriormente.</p>
<ul>
<li class="fragment">Definir uma função, e sua docstring, e depois pedir para o Copilot gerar o código dela.</li>
</ul>
</div>
</section>
<section id="section-14" class="slide level2">
<h2></h2>
<p>Ao fazer isso, devemos seguir o processo que já vimos antes:</p>
<ul>
<li class="fragment">verificar a corretude do código (testes),</li>
<li class="fragment">corrigir os bugs,</li>
<li class="fragment">e talvez decompor o problema.</li>
</ul>
<div class="fragment">
<p>Mas aqui na aula vamos nos concentrar na interação com o Copilot para automizarmos a tarefa que precisamos.</p>
<ul>
<li class="fragment">Para manter o foco no conteúdo que estamos trabalhando neste capítulo.</li>
</ul>
</div>
</section>
<section id="section-15" class="slide level2">
<h2></h2>
<p>Nós poderíamos pedir ao Copilot ou ao ChatGPT para fazer a ferramenta completa.</p>
<ul>
<li class="fragment">Mas vamos manter a ideia de criar funções.</li>
</ul>
<div class="fragment">
<p>Acreditamos que vale a pena trabalharmos com funções, documentadas.</p>
<ul>
<li class="fragment">De forma que seja mais fácil, no futuro, fazer alguma melhoria ou evolução necessária na ferramenta.</li>
</ul>
</div>
</section></section>
<section>
<section id="exemplo-1-lista-de-compras" class="title-slide slide level1 center" data-background-color="#40666e">
<h1>Exemplo 1: Lista de compras</h1>

</section>
<section id="section-16" class="slide level2">
<h2></h2>
<p>Suponha que você precise enviar uma <strong>lista de compras</strong> para alguém por WhatsApp ou e-mail.</p>
<ul>
<li class="fragment">E que essa lista precise ser <strong>numerada</strong>, com <strong>um item por linha</strong>, e em <strong>ordem alfabética</strong>.</li>
</ul>
<div class="fragment">
<p>Mas você recebeu a lista de compras de alguém (talvez seu chefe)</p>
<ul>
<li class="fragment">que simplesmente digitou os itens separados por espaço, e em uma ordem qualquer.</li>
</ul>
</div>
<div class="fragment">
<p>Vamos usar o Copilot para automatizar essa tarefa.</p>
</div>
</section>
<section id="section-17" class="slide level2">
<h2></h2>
<p>Como você recebeu os itens por e-mail ou WhatsApp,</p>
<ul>
<li class="fragment">a ferramenta será mais útil se pudermos <strong>copiar (Ctrl+c)</strong> os itens da mensagem.</li>
<li class="fragment">e <strong>colar (Ctrl+v)</strong> na nossa ferramenta para ela gerar a lista numerada.</li>
<li class="fragment">Caso contrário, teríamos que redigitar a lista
<ul>
<li class="fragment">e aí não estaríamos economizando tempo.</li>
</ul></li>
</ul>
<div class="fragment">
<p>Para isso, precisaremos usar a <span class="alert">Área de Transferência</span> (<em>Clipboard</em>) do Sistema Operacional.</p>
</div>
</section>
<section id="section-18" class="slide level2">
<h2></h2>
<p>Essa <strong>Área de Transferência</strong> é onde ficam os últimos dados que copiamos com o Ctrl+c.</p>
<div class="fragment">
<p>Podemos então criar uma ferramenta que obtenha as palavras da Área de Transferência;</p>
<ul>
<li class="fragment">gere a lista numerada;</li>
<li class="fragment">e copie a lista numerada de volta para a Área de Transferência.</li>
</ul>
</div>
<div class="fragment">
<p>Assim, depois de rodar a ferramenta, podemos simplesmente colar (Ctrl+v) a lista numerada onde quisermos.</p>
</div>
</section>
<section id="section-19" class="slide level2">
<h2></h2>
<p>Basicamente o que precisamos fazer em um programa em Python é:</p>
<ul>
<li class="fragment">Ler o conteúdo da Área de Transferência e guardar em uma string.</li>
<li class="fragment">Gerar a lista numerada e ordenada a partir dessa string.</li>
<li class="fragment">Guardar a lista em uma nova string.</li>
<li class="fragment">Colocar a nova string na Área de Transferência.</li>
</ul>
<div class="fragment">
<p>Mas como podemos usar a Área de Transferência em um programa Python?</p>
</div>
</section>
<section id="section-20" class="slide level2">
<h2></h2>
<p>Vamos descobrir isso usando a janela de chat do Copilot.</p>
<ul>
<li class="fragment">Mas vamos fazer uma exploração mais ampla antes de implementar uma solução.</li>
</ul>
<div class="fragment">
<p>Vamos abrir uma pasta vazia no VS Code e usar o modo <code>Ask</code> do chat do Copilot.</p>
</div>
</section>
<section id="section-21" class="slide level2">
<h2></h2>
<div title="Prompt">
<div class="callout callout-caution no-icon callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<p><strong>Prompt</strong></p>
</div>
<div class="callout-content">
<p>Eu gostaria de escrever um programa em Python que acessa a área de transferência e que permita copiar e colar usando a área de transferência. Como posso fazer isso?</p>
</div>
</div>
</div>
</div>
</section>
<section id="section-22" class="slide level2">
<h2></h2>
<div title="GitHub Copilot">
<div class="callout callout-note no-icon callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<p><strong>GitHub Copilot</strong></p>
</div>
<div class="callout-content">
<p>Você pode usar o módulo <code>pyperclip</code> para acessar a área de transferência no Python.</p>
<p>Ele permite copiar e colar texto facilmente. Veja como fazer:</p>
<ol type="1">
<li>Instale o pacote:</li>
</ol>
<div class="sourceCode" id="cb1"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb1-1"><a></a><span class="ex">pip</span> install pyperclip</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<ol start="2" type="1">
<li>Exemplo de código para copiar e colar:</li>
</ol>
<div class="sourceCode" id="cb2"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a></a><span class="im">import</span> pyperclip</span>
<span id="cb2-2"><a></a></span>
<span id="cb2-3"><a></a><span class="co"># Copiar texto para a área de transferência</span></span>
<span id="cb2-4"><a></a>pyperclip.copy(<span class="st">"Olá, área de transferência!"</span>)</span>
<span id="cb2-5"><a></a></span>
<span id="cb2-6"><a></a><span class="co"># Colar (obter) texto da área de transferência</span></span>
<span id="cb2-7"><a></a>texto <span class="op">=</span> pyperclip.paste()</span>
<span id="cb2-8"><a></a><span class="bu">print</span>(<span class="st">"Texto copiado:"</span>, texto)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Esse código copia um texto para a área de transferência e depois lê o que está lá.<br>
Funciona em Linux, Windows e macOS.</p>
</div>
</div>
</div>
</div>
</section>
<section id="section-23" class="slide level2">
<h2></h2>
<p>A resposta do Copilot nos ensina que podemos usar o módulo <code>pyperclip</code> para interagir com a Área de Transferência em um programa em Python.</p>
<ul>
<li class="fragment">E nos dá um exemplo de como usar o módulo.</li>
<li class="fragment">Ele também nos diz como instalar o módulo.
<ul>
<li class="fragment">O que mostra que ele é não é <em>built-in</em>.</li>
</ul></li>
</ul>
<div class="fragment">
<p>Mas será que não daria para fazer nossa ferramenta sem instalar um módulo?</p>
<ul>
<li class="fragment">Vamos perguntar ao Copilot.</li>
</ul>
</div>
</section>
<section id="section-24" class="slide level2">
<h2></h2>
<div title="Prompt">
<div class="callout callout-caution no-icon callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<p><strong>Prompt</strong></p>
</div>
<div class="callout-content">
<p>Existe alguma forma de fazer isso sem precisar instalar um módulo Python?</p>
</div>
</div>
</div>
</div>
</section>
<section id="section-25" class="slide level2">
<h2></h2>
<div title="GitHub Copilot">
<div class="callout callout-note no-icon callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<p><strong>GitHub Copilot</strong></p>
</div>
<div class="callout-content">
<p>Sim, é possível acessar a área de transferência sem instalar módulos externos, mas depende do sistema operacional. No Linux, você pode usar comandos do sistema como <code>xclip</code> ou <code>xsel</code> via <code>subprocess</code>. Veja um exemplo usando <code>xclip</code>:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a></a><span class="im">import</span> subprocess</span>
<span id="cb3-2"><a></a></span>
<span id="cb3-3"><a></a><span class="co"># Copiar texto para a área de transferência</span></span>
<span id="cb3-4"><a></a>texto <span class="op">=</span> <span class="st">"Olá, área de transferência!"</span></span>
<span id="cb3-5"><a></a>process <span class="op">=</span> subprocess.Popen([<span class="st">'xclip'</span>, <span class="st">'-selection'</span>, <span class="st">'clipboard'</span>], stdin<span class="op">=</span>subprocess.PIPE)</span>
<span id="cb3-6"><a></a>process.communicate(<span class="bu">input</span><span class="op">=</span>texto.encode())</span>
<span id="cb3-7"><a></a></span>
<span id="cb3-8"><a></a><span class="co"># Colar (obter) texto da área de transferência</span></span>
<span id="cb3-9"><a></a>process <span class="op">=</span> subprocess.Popen([<span class="st">'xclip'</span>, <span class="st">'-selection'</span>, <span class="st">'clipboard'</span>, <span class="st">'-o'</span>], stdout<span class="op">=</span>subprocess.PIPE)</span>
<span id="cb3-10"><a></a>saida, _ <span class="op">=</span> process.communicate()</span>
<span id="cb3-11"><a></a><span class="bu">print</span>(<span class="st">"Texto copiado:"</span>, saida.decode())</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p><strong>Observações:</strong></p>
<ul>
<li>Você precisa ter o <code>xclip</code> instalado (<code>sudo apt install xclip</code>).</li>
<li>Para Windows, pode-se usar <code>clip</code> e <code>powershell</code> via subprocess.</li>
<li>Para macOS, use <code>pbcopy</code> e <code>pbpaste</code>.</li>
</ul>
<p>Se precisar de exemplos para outros sistemas, é só pedir!</p>
</div>
</div>
</div>
</div>
</section>
<section id="section-26" class="slide level2">
<h2></h2>
<p>Bom essa solução tem uma desvantagem: depende de um programa externo e do sistema operacional.</p>
<ul>
<li class="fragment">Se formos tratar a tarefa apenas uma única vez poderia nos atender.</li>
<li class="fragment">Mas pensando em usos futuros, não é a melhor solução.</li>
</ul>
<div class="fragment">
<p>Vamos explorar mais soluções.</p>
</div>
</section>
<section id="section-27" class="slide level2">
<h2></h2>
<div title="Prompt">
<div class="callout callout-caution no-icon callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<p><strong>Prompt</strong></p>
</div>
<div class="callout-content">
<p>Existe algum outro jeito de fazer isso sem precisar instalar um módulo Python?</p>
</div>
</div>
</div>
</div>
</section>
<section id="section-28" class="slide level2">
<h2></h2>
<div title="GitHub Copilot">
<div class="callout callout-note no-icon callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<p><strong>GitHub Copilot</strong></p>
</div>
<div class="callout-content">
<p>Sim, mas você ainda vai precisar de algum utilitário externo já instalado no sistema, como <code>xclip</code> ou <code>xsel</code> no Linux, <code>pbcopy</code>/<code>pbpaste</code> no macOS, ou <code>clip</code> no Windows.</p>
<p>O Python puro não oferece acesso direto à área de transferência na biblioteca padrão.</p>
<p>No Linux, por exemplo, se o <code>xclip</code> já estiver instalado, você pode usar o seguinte código:</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a></a><span class="im">import</span> subprocess</span>
<span id="cb4-2"><a></a></span>
<span id="cb4-3"><a></a><span class="co"># Copiar texto para a área de transferência</span></span>
<span id="cb4-4"><a></a>subprocess.run(<span class="st">"echo 'Texto para copiar' | xclip -selection clipboard"</span>, shell<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb4-5"><a></a></span>
<span id="cb4-6"><a></a><span class="co"># Colar texto da área de transferência</span></span>
<span id="cb4-7"><a></a>resultado <span class="op">=</span> subprocess.run(<span class="st">"xclip -selection clipboard -o"</span>, shell<span class="op">=</span><span class="va">True</span>, capture_output<span class="op">=</span><span class="va">True</span>, text<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb4-8"><a></a><span class="bu">print</span>(<span class="st">"Texto colado:"</span>, resultado.stdout)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p><strong>Resumo:</strong><br>
Sem instalar módulos Python, você pode usar comandos do sistema operacional via <code>subprocess</code>, desde que o utilitário de área de transferência já esteja disponível no seu sistema.</p>
</div>
</div>
</div>
</div>
</section>
<section id="section-29" class="slide level2">
<h2></h2>
<p>Bom, essa resposta não ajudou muito, afinal continua basicamente fazendo a mesma coisa da resposta anterior</p>
<div class="fragment">
<p>No livro, a primeira solução dada pelo Copilot usava o módulo <code>tkinter</code>.</p>
<ul>
<li class="fragment">Que tem a limitação de só funcionar em ambientes gráficos (não funciona em servidores Linux, por exemplo).</li>
</ul>
</div>
<div class="fragment">
<p>Ao pedir outra opção, o Copilot sugeriu um código específico para Windows usando <code>win32clipboard</code>.</p>
<ul>
<li class="fragment">Porque os autores estavam em ambiente Windows.</li>
<li class="fragment">Mas tem o mesmo tipo de limitação da nossa solução com <code>xclip</code>.</li>
</ul>
</div>
</section>
<section id="section-30" class="slide level2">
<h2></h2>
<p>Avaliando então as opções que temos, a melhor é usar o módulo <code>pyperclip</code>.</p>
<ul>
<li class="fragment">Afinal instalar um módulo não é algo tão complicado.</li>
<li class="fragment">E o <code>pyperclip</code> funciona em Linux, Windows e macOS,
<ul>
<li class="fragment">sem depender de programas externos.</li>
</ul></li>
</ul>
</section>
<section id="section-31" class="slide level2">
<h2></h2>
<div class="callout callout-note callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>Mas por que devemos explorar e entender várias opções?</strong></p>
</div>
<div class="callout-content">
<p>Há vários motivos porque não deveríamos simplesmente usar a primeira opção do Copilot:</p>
<ul>
<li class="fragment">Pode não funcionar em todos os sistemas operacionais.
<ul>
<li class="fragment">O que limita os potenciais usuários da ferramenta.</li>
</ul></li>
<li class="fragment">Pode não funcionar para a tarefa que precisamos, ou pode ser que cheguemos em um ponto que ficamos travados em como resolver um problema.
<ul>
<li class="fragment">E aí sabermos que temos outras opções pode nos ajudar a sair do impasse.</li>
</ul></li>
<li class="fragment">Módulos são atualizados com frequência.
<ul>
<li class="fragment">E funções que existiam, podem não existir nas versões mais atuais.</li>
<li class="fragment">Ou sua forma de uso pode ter sido alterada.</li>
<li class="fragment">E, assim, uma sugestão do Copilot pode não funcionar mais.</li>
</ul></li>
</ul>
</div>
</div>
</div>
</section>
<section id="section-32" class="slide level2">
<h2></h2>
<p>Agora que sabemos como acessar a Área de Transferência, podemos criar nossa ferramenta.</p>
<ul>
<li class="fragment">como vamos precisar instalar um módulo, vamos aproveitar para aprender como fazer isso do jeito mais correto.</li>
<li class="fragment">Claro, com a ajuda do Copilot.</li>
</ul>
<div class="fragment">
<div title="Prompt">
<div class="callout callout-caution no-icon callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<p><strong>Prompt</strong></p>
</div>
<div class="callout-content">
<p>Vou seguir com a sugestão que usa pyperclip. Mas, antes disso, me explique a melhor forma de instalar um módulo Python para um projeto?</p>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="section-33" class="slide level2">
<h2></h2>
<div title="GitHub Copilot">
<div class="callout callout-note no-icon callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<p><strong>GitHub Copilot</strong></p>
</div>
<div class="callout-content">
<p>A melhor forma de instalar um módulo Python para um projeto é usar um ambiente virtual. Assim, as dependências ficam isoladas e não afetam outros projetos ou o sistema.</p>
<p><strong>Passos recomendados:</strong></p>
<ol type="1">
<li><strong>Crie um ambiente virtual na pasta do projeto:</strong></li>
</ol>
<div class="sourceCode" id="cb5"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb5-1"><a></a><span class="ex">python3</span> <span class="at">-m</span> venv venv</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<ol start="2" type="1">
<li><strong>Ative o ambiente virtual:</strong></li>
</ol>
<div class="sourceCode" id="cb6"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb6-1"><a></a><span class="bu">source</span> venv/bin/activate</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<ol start="3" type="1">
<li><strong>Instale o módulo desejado (exemplo: pyperclip):</strong></li>
</ol>
<div class="sourceCode" id="cb7"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb7-1"><a></a><span class="ex">pip</span> install pyperclip</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<ol start="4" type="1">
<li><strong>(Opcional) Gere um arquivo de dependências:</strong></li>
</ol>
<div class="sourceCode" id="cb8"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb8-1"><a></a><span class="ex">pip</span> freeze <span class="op">&gt;</span> requirements.txt</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Assim, você mantém seu projeto organizado e fácil de compartilhar ou replicar em outros ambientes.</p>
</div>
</div>
</div>
</div>
</section>
<section id="section-34" class="slide level2">
<h2></h2>
<p>O Copilot nos ensinou a criar um ambiente virtual.</p>
<ul>
<li class="fragment">De modo que a instalação do módulo <code>pyperclip</code> fique dentro da pasta do próprio projeto.</li>
<li class="fragment">Evitando interferências e conflitos de versões com outros projetos.</li>
</ul>
<div class="fragment">
<p>Também aprendemos a gerar um arquivo <code>requirements.txt</code></p>
<ul>
<li class="fragment">mas não ficou muito claro para que ele serve, já que foi gerado somente ao final.</li>
</ul>
</div>
<div class="fragment">
<p>Vamos perguntar ao Copilot.</p>
</div>
</section>
<section id="section-35" class="slide level2">
<h2></h2>
<div title="Prompt">
<div class="callout callout-caution no-icon callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<p><strong>Prompt</strong></p>
</div>
<div class="callout-content">
<p>Para que serve o arquivo requirements.txt?</p>
</div>
</div>
</div>
</div>
<div class="fragment">
<div title="GitHub Copilot">
<div class="callout callout-note no-icon callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<p><strong>GitHub Copilot</strong></p>
</div>
<div class="callout-content">
<p>O arquivo requirements.txt serve para listar todas as dependências (módulos e suas versões) necessárias para o seu projeto Python. Ele facilita a instalação dessas dependências em outros ambientes ou por outros desenvolvedores, usando o comando:</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb9-1"><a></a><span class="ex">pip</span> install <span class="at">-r</span> requirements.txt</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Assim, todos os pacotes listados no arquivo serão instalados automaticamente, garantindo que o projeto funcione corretamente.</p>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="section-36" class="slide level2">
<h2></h2>
<p>Agora ficou mais claro.</p>
<ul>
<li class="fragment">Quando formos instalar o projeto em outro computador, ou quando alguém for usar o projeto,</li>
<li class="fragment">basta criar um ambiente virtual e rodar o comando <code>pip install -r requirements.txt</code>.</li>
</ul>
<div class="fragment">
<p>Vamos, enfim, criar nossa ferramenta.</p>
<ul>
<li class="fragment">Para isso, vamos, criar um arquivo Python, importar o módulo <code>pyperclip</code></li>
<li class="fragment">e definir a assinatura e docstring função que gera a lista numerada.</li>
</ul>
</div>
</section>
<section id="section-37" class="slide level2">
<h2></h2>
<p><strong>Prompt</strong></p>
<div class="r-fit-text">
<div class="sourceCode" id="cb10"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb10-1"><a></a><span class="im">import</span> pyperclip</span>
<span id="cb10-2"><a></a></span>
<span id="cb10-3"><a></a><span class="kw">def</span> gerar_lista_numerada():</span>
<span id="cb10-4"><a></a>    <span class="co">""""</span></span>
<span id="cb10-5"><a></a><span class="co">    A área de transferêcia tem linhas de texto contendo</span></span>
<span id="cb10-6"><a></a><span class="co">    palavras separadas por espaços e/ou vírgulas.</span></span>
<span id="cb10-7"><a></a></span>
<span id="cb10-8"><a></a><span class="co">    A função extrai as palavras obtidas da área de transferência,</span></span>
<span id="cb10-9"><a></a><span class="co">    ordena-as em ordem alfabética e cria uma lista numerada com</span></span>
<span id="cb10-10"><a></a><span class="co">    um item por linha.</span></span>
<span id="cb10-11"><a></a></span>
<span id="cb10-12"><a></a><span class="co">    O resultado é copiado de volta para a área de transferência.    </span></span>
<span id="cb10-13"><a></a><span class="co">    """</span></span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="section-38" class="slide level2">
<h2></h2>
<p>Código gerado pelo Copilot.</p>
<div class="r-fit-text">
<div class="sourceCode" id="cb11"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb11-1"><a></a><span class="kw">def</span> gerar_lista_numerada():</span>
<span id="cb11-2"><a></a>    <span class="co">""""</span></span>
<span id="cb11-3"><a></a><span class="co">    A área de transferêcia tem linhas de texto contendo</span></span>
<span id="cb11-4"><a></a><span class="co">    palavras separadas por espaços e/ou vírgulas.</span></span>
<span id="cb11-5"><a></a></span>
<span id="cb11-6"><a></a><span class="co">    A função extrai as palavras obtidas da área de transferência,</span></span>
<span id="cb11-7"><a></a><span class="co">    ordena-as em ordem alfabética e cria uma lista numerada com</span></span>
<span id="cb11-8"><a></a><span class="co">    um item por linha.</span></span>
<span id="cb11-9"><a></a></span>
<span id="cb11-10"><a></a><span class="co">    O resultado é copiado de volta para a área de transferência.    </span></span>
<span id="cb11-11"><a></a><span class="co">    """</span></span>
<span id="cb11-12"><a></a>    <span class="co"># Obtém o texto da área de transferência</span></span>
<span id="cb11-13"><a></a>    texto <span class="op">=</span> pyperclip.paste()</span>
<span id="cb11-14"><a></a></span>
<span id="cb11-15"><a></a>    <span class="co"># Substitui vírgulas por espaços e divide o texto em palavras</span></span>
<span id="cb11-16"><a></a>    palavras <span class="op">=</span> texto.replace(<span class="st">','</span>, <span class="st">' '</span>).split()</span>
<span id="cb11-17"><a></a></span>
<span id="cb11-18"><a></a>    <span class="co"># Remove duplicatas e ordena as palavras em ordem alfabética</span></span>
<span id="cb11-19"><a></a>    palavras_unicas <span class="op">=</span> <span class="bu">sorted</span>(<span class="bu">set</span>(palavras))</span>
<span id="cb11-20"><a></a></span>
<span id="cb11-21"><a></a>    <span class="co"># Cria a lista numerada</span></span>
<span id="cb11-22"><a></a>    lista_numerada <span class="op">=</span> [<span class="ss">f"</span><span class="sc">{</span>i <span class="op">+</span> <span class="dv">1</span><span class="sc">}</span><span class="ss">. </span><span class="sc">{</span>palavra<span class="sc">}</span><span class="ss">"</span> <span class="cf">for</span> i, palavra <span class="kw">in</span> <span class="bu">enumerate</span>(palavras_unicas)]</span>
<span id="cb11-23"><a></a></span>
<span id="cb11-24"><a></a>    <span class="co"># Junta a lista em uma única string com quebras de linha</span></span>
<span id="cb11-25"><a></a>    resultado <span class="op">=</span> <span class="st">'</span><span class="ch">\n</span><span class="st">'</span>.join(lista_numerada)</span>
<span id="cb11-26"><a></a></span>
<span id="cb11-27"><a></a>    <span class="co"># Copia o resultado de volta para a área de transferência</span></span>
<span id="cb11-28"><a></a>    pyperclip.copy(resultado)</span>
<span id="cb11-29"><a></a></span>
<span id="cb11-30"><a></a><span class="cf">if</span> <span class="va">__name__</span> <span class="op">==</span> <span class="st">"__main__"</span>:</span>
<span id="cb11-31"><a></a>    gerar_lista_numerada()</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="section-39" class="slide level2">
<h2></h2>
<div class="callout callout-tip callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>Dica</strong></p>
</div>
<div class="callout-content">
<p>Como nós criamos o ambiente virtual pelo terminal do VS Code, precisamos conferir se o VS Code identificou automaticamente o ambiente virtual, caso contrário, se tentarmos usar a opção <code>Run</code>, o programa não vai funcionar (pois não conseguirá importar o módulo <code>pyperclip</code>).</p>
<p>Precisamos escolher a versão do Python que está dentro do ambiente virtual. Basta clicar no canto inferior direito do VS Code e escolher o Python correto.</p>
<p>Obs.: se criarmos o ambiente virtual pelo VS Code (<code>Ctrl+Shift+P</code> e escolhendo <code>Python: Create Environment</code>), o VS Code já escolhe o Python correto.</p>
</div>
</div>
</div>
</section>
<section id="section-40" class="slide level2">
<h2></h2>
<p>Vamos então testar o nosso programa.</p>
<div class="fragment">
<p>Suponha que tenhamos recebido a seguinte lista de compras:</p>
<ul>
<li class="fragment">feijão, arroz, sorvete, café, batata, óleo, cebola</li>
</ul>
</div>
<div class="fragment">
<p>Copie a lista acima (Ctrl+c) e rode o programa.</p>
<ul>
<li class="fragment">Em seguida cole (Ctrl+v) a lista numerada em algum editor de texto.</li>
</ul>
</div>
</section>
<section id="section-41" class="slide level2">
<h2></h2>
<p>Veja que deu quase tudo certo.</p>
<ul>
<li class="fragment">Exceto que a palavra <code>óleo</code> apareceu fora da ordem alfabética.</li>
</ul>
<div class="fragment">
<pre class="text"><code>1. arroz
2. batata
3. café
4. cebola
5. feijão
6. sorvete
7. óleo</code></pre>
</div>
</section>
<section id="section-42" class="slide level2">
<h2></h2>
<p>Provavelmente o erro aconteceu porque a palavra tem acento.</p>
<ul>
<li class="fragment">Vamos pedir ao Copilot para corrigir isso.</li>
</ul>
<div class="fragment">
<div title="Prompt">
<div class="callout callout-caution no-icon callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<p><strong>Prompt</strong></p>
</div>
<div class="callout-content">
<p>A ordenação está errada, pois a palavra “óleo” deveria aparecer antes de “sorvete”. Pode corrigir isso?</p>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="section-43" class="slide level2">
<h2></h2>
<div title="GitHub Copilot _(início)_">
<div class="callout callout-note no-icon callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<p><strong>GitHub Copilot <em>(início)</em></strong></p>
</div>
<div class="callout-content">
<p>Claro! O problema ocorre porque a ordenação padrão do Python (<code>sorted</code>) não considera corretamente os acentos para a ordem alfabética em português. Para corrigir, você pode usar o módulo <code>locale</code> e configurar para <code>'pt_BR.UTF-8'</code>. Veja como ajustar:</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb13-1"><a></a><span class="im">import</span> pyperclip</span>
<span id="cb13-2"><a></a><span class="im">import</span> locale</span>
<span id="cb13-3"><a></a></span>
<span id="cb13-4"><a></a><span class="kw">def</span> gerar_lista_numerada():</span>
<span id="cb13-5"><a></a>    <span class="co">"""</span></span>
<span id="cb13-6"><a></a><span class="co">    A área de transferêcia tem linhas de texto contendo</span></span>
<span id="cb13-7"><a></a><span class="co">    palavras separadas por espaços e/ou vírgulas.</span></span>
<span id="cb13-8"><a></a></span>
<span id="cb13-9"><a></a><span class="co">    A função extrai as palavras obtidas da área de transferência,</span></span>
<span id="cb13-10"><a></a><span class="co">    ordena-as em ordem alfabética e cria uma lista numerada com</span></span>
<span id="cb13-11"><a></a><span class="co">    um item por linha.</span></span>
<span id="cb13-12"><a></a></span>
<span id="cb13-13"><a></a><span class="co">    O resultado é copiado de volta para a área de transferência.    </span></span>
<span id="cb13-14"><a></a><span class="co">    """</span></span>
<span id="cb13-15"><a></a>    <span class="co"># Configura a ordenação para o padrão do português do Brasil</span></span>
<span id="cb13-16"><a></a>    locale.setlocale(locale.LC_COLLATE, <span class="st">'pt_BR.UTF-8'</span>)</span>
<span id="cb13-17"><a></a></span>
<span id="cb13-18"><a></a>    <span class="co"># Obtém o texto da área de transferência</span></span>
<span id="cb13-19"><a></a>    texto <span class="op">=</span> pyperclip.paste()</span>
<span id="cb13-20"><a></a></span>
<span id="cb13-21"><a></a>    <span class="co"># Substitui vírgulas por espaços e divide o texto em palavras</span></span>
<span id="cb13-22"><a></a>    palavras <span class="op">=</span> texto.replace(<span class="st">','</span>, <span class="st">' '</span>).split()</span>
<span id="cb13-23"><a></a></span>
<span id="cb13-24"><a></a>    <span class="co"># Remove duplicatas e ordena as palavras em ordem alfabética considerando acentos</span></span>
<span id="cb13-25"><a></a>    palavras_unicas <span class="op">=</span> <span class="bu">sorted</span>(<span class="bu">set</span>(palavras), key<span class="op">=</span>locale.strxfrm)</span>
<span id="cb13-26"><a></a></span>
<span id="cb13-27"><a></a>    <span class="co"># Cria a lista numerada</span></span>
<span id="cb13-28"><a></a>    lista_numerada <span class="op">=</span> [<span class="ss">f"</span><span class="sc">{</span>i <span class="op">+</span> <span class="dv">1</span><span class="sc">}</span><span class="ss">. </span><span class="sc">{</span>palavra<span class="sc">}</span><span class="ss">"</span> <span class="cf">for</span> i, palavra <span class="kw">in</span> <span class="bu">enumerate</span>(palavras_unicas)]</span>
<span id="cb13-29"><a></a></span>
<span id="cb13-30"><a></a>    <span class="co"># Junta a lista em uma única string com quebras de linha</span></span>
<span id="cb13-31"><a></a>    resultado <span class="op">=</span> <span class="st">'</span><span class="ch">\n</span><span class="st">'</span>.join(lista_numerada)</span>
<span id="cb13-32"><a></a></span>
<span id="cb13-33"><a></a>    <span class="co"># Copia o resultado de volta para a área de transferência</span></span>
<span id="cb13-34"><a></a>    pyperclip.copy(resultado)</span>
<span id="cb13-35"><a></a></span>
<span id="cb13-36"><a></a><span class="cf">if</span> <span class="va">__name__</span> <span class="op">==</span> <span class="st">"__main__"</span>:</span>
<span id="cb13-37"><a></a>    gerar_lista_numerada()</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
</section>
<section id="section-44" class="slide level2">
<h2></h2>
<div title="GitHub Copilot _(continuação)_">
<div class="callout callout-note no-icon callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<p><strong>GitHub Copilot <em>(continuação)</em></strong></p>
</div>
<div class="callout-content">
<p>Agora, palavras acentuadas serão ordenadas corretamente conforme o português.</p>
<p><strong>Obs:</strong> Certifique-se de que o locale <code>pt_BR.UTF-8</code> está instalado no seu sistema Linux. Se não estiver, instale com:</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb14-1"><a></a><span class="fu">sudo</span> locale-gen pt_BR.UTF-8</span>
<span id="cb14-2"><a></a><span class="fu">sudo</span> update-locale</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
</section>
<section id="section-45" class="slide level2">
<h2></h2>
<p>Agora sim!</p>
<ul>
<li class="fragment">Temos uma ferramenta que nos economiza tempo pegar gerar a lista no formato correto.</li>
<li class="fragment">Claro que esse é um exemplo simples e didático.
<ul>
<li class="fragment">Seguindo a mesma ideia você pode criar ferramentas para tarefas mais complexas.</li>
</ul></li>
</ul>
</section>
<section id="section-46" class="slide level2">
<h2></h2>
<p>Mas tem algo que ainda é complicado em nossa ferramenta.</p>
<ul>
<li class="fragment">Precisamos usar o VS Code para rodar o programa.</li>
<li class="fragment">Ou então abrir o terminal, navegar até a pasta do projeto, ativar o ambiente virtual e rodar o programa.</li>
<li class="fragment">Isso não é muito prático.</li>
</ul>
<div class="fragment">
<p>Seria melhor se pudéssemos simplesmente clicar duas vezes em um ícone na área de trabalho.</p>
<ul>
<li class="fragment">E aí a ferramenta rodaria sem precisar abrir o VS Code ou o terminal.</li>
</ul>
</div>
</section>
<section id="section-47" class="slide level2">
<h2></h2>
<p>Vamos conversar com o Copilot para descobrir como fazer isso.</p>
<div class="fragment">
<div title="Prompt">
<div class="callout callout-caution no-icon callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<p><strong>Prompt</strong></p>
</div>
<div class="callout-content">
<p>Eu gostaria que esse programa estivesse disponível para o usuário como um comando de terminal. Sem precisar entrar na pasta do projeto, ativer o ambiente virtual e rodar o programa manualmente. Como posso fazer isso?</p>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="section-48" class="slide level2">
<h2></h2>
<div title="GitHub Copilot _(início)_">
<div class="callout callout-note no-icon callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<p><strong>GitHub Copilot <em>(início)</em></strong></p>
</div>
<div class="callout-content">
<p>Para tornar seu programa disponível como um comando de terminal, você pode empacotá-lo como um <strong>script executável</strong> e instalá-lo no sistema.</p>
<p>O jeito mais comum em projetos Python é criar um <strong>entry point</strong> usando o <code>setuptools</code>. Veja como fazer:</p>
<p><strong>1. Crie um arquivo <code>setup.py</code> na raiz do projeto:</strong></p>
<div class="sourceCode" id="cb15"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb15-1"><a></a><span class="im">from</span> setuptools <span class="im">import</span> setup</span>
<span id="cb15-2"><a></a></span>
<span id="cb15-3"><a></a>setup(</span>
<span id="cb15-4"><a></a>    name<span class="op">=</span><span class="st">"gerador-lista-numerada"</span>,</span>
<span id="cb15-5"><a></a>    version<span class="op">=</span><span class="st">"1.0"</span>,</span>
<span id="cb15-6"><a></a>    py_modules<span class="op">=</span>[<span class="st">"gerador_lista_numerada"</span>],</span>
<span id="cb15-7"><a></a>    install_requires<span class="op">=</span>[<span class="st">"pyperclip"</span>],</span>
<span id="cb15-8"><a></a>    entry_points<span class="op">=</span>{</span>
<span id="cb15-9"><a></a>        <span class="st">"console_scripts"</span>: [</span>
<span id="cb15-10"><a></a>            <span class="st">"gerador-lista-numerada=gerador_lista_numerada:gerar_lista_numerada"</span>,</span>
<span id="cb15-11"><a></a>        ],</span>
<span id="cb15-12"><a></a>    },</span>
<span id="cb15-13"><a></a>)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
</section>
<section id="section-49" class="slide level2">
<h2></h2>
<div title="GitHub Copilot _(continuação)_">
<div class="callout callout-note no-icon callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<p><strong>GitHub Copilot <em>(continuação)</em></strong></p>
</div>
<div class="callout-content">
<p><strong>2. Instale o pacote no modo editável (para desenvolvimento):</strong></p>
<p>No terminal, dentro da pasta do projeto:</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb16-1"><a></a><span class="ex">pip</span> install <span class="at">--user</span> <span class="at">--editable</span> .</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p><strong>3. Use o comando no terminal</strong></p>
<p>Agora, você pode rodar o comando de qualquer lugar:</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb17-1"><a></a><span class="ex">gerador-lista-numerada</span></span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<hr>
<p><strong>Dicas:</strong></p>
<ul>
<li>O comando será instalado em <code>~/.local/bin</code> (Linux). Certifique-se de que esse diretório está no seu <code>$PATH</code>.</li>
<li>Para outros usuários do sistema, use <code>sudo pip install .</code> (não recomendado para ambientes compartilhados).</li>
<li>Se quiser distribuir, pode empacotar e publicar no PyPI.</li>
</ul>
<p>Se quiser um nome de comando diferente, basta alterar em <code>console_scripts</code>.</p>
</div>
</div>
</div>
</div>
</section>
<section id="section-50" class="slide level2">
<h2></h2>
<p>Legal! Agora podemos abrir um terminal, rodar o comando <code>gerador-lista-numerada</code> e pronto!</p>
<ul>
<li class="fragment">Teremos nossa lista de compras numerada na Área de Transferência.</li>
</ul>
</section>
<section id="no-entanto" class="slide level2">
<h2>No entanto…</h2>
<div class="fragment">
<p>Bom, sistemas em produção são sempre mais complicados.</p>
<ul>
<li class="fragment">O código que apresentei até aqui funcionou no meu computador.</li>
<li class="fragment">Mas ao testar no notebook para preparar a aula, tive que fazer alguns ajustes.
<ul>
<li class="fragment">Porque nele, a versão do Ubuntu e do Python são mais recentes.</li>
</ul></li>
<li class="fragment">E, claro, o Copilot me ajudou a fazer as alterações necessárias.</li>
</ul>
</div>
</section>
<section id="section-51" class="slide level2">
<h2></h2>
<p>O problema é que nas versões mais recentes do Python, o comando abaixo não é permitido:</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb18-1"><a></a><span class="ex">pip</span> install <span class="at">--user</span> <span class="at">--editable</span> .</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="fragment">
<p>Isso para proteger a integridade do sistema, evitando instalação de pacotes sem usar um ambiente virtual.</p>
<ul>
<li class="fragment">Mas, para o nosso caso, queremos mesmo instalar o pacote para o usuário.</li>
<li class="fragment">E, assim, termos o comando disponível globalmente.</li>
</ul>
</div>
</section>
<section id="section-52" class="slide level2">
<h2></h2>
<p>Perguntando então ao Copilot, precisei instalar com o comando abaixo:</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb19-1"><a></a><span class="ex">pip</span> install <span class="at">--user</span> <span class="at">--break-system-packages</span> .</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="fragment">
<p>E também precisei rodar os comandos abaixo para garantir que o diretório <code>~/.local/bin</code> estivesse no meu <code>$PATH</code>.</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb20-1"><a></a><span class="bu">echo</span> <span class="st">'export PATH=$PATH:~/.local/bin'</span> <span class="op">&gt;&gt;</span> ~/.bashrc</span>
<span id="cb20-2"><a></a><span class="bu">source</span> ~/.bashrc</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="section-53" class="slide level2">
<h2></h2>
<p>Mas será que não podemos fazer algo ainda mais prático?</p>
<ul>
<li class="fragment">Para um usuário leigo, é ruim ter que abrir um terminal e saber o nome do comando.</li>
</ul>
<div class="fragment">
<p>Bora, conversar com o Copilot novamente.</p>
<div title="Prompt">
<div class="callout callout-caution no-icon callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<p><strong>Prompt</strong></p>
</div>
<div class="callout-content">
<p>E como faço para ter um ícone na área de trabalho para executar o programa?</p>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="section-54" class="slide level2">
<h2></h2>
<div title="GitHub Copilot _(início)_">
<div class="callout callout-note no-icon callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<p><strong>GitHub Copilot <em>(início)</em></strong></p>
</div>
<div class="callout-content">
<p>Para criar um atalho com ícone na área de trabalho (no Linux), siga estes passos:</p>
<p><strong>1. Crie um arquivo <code>.desktop</code></strong></p>
<p>Crie um arquivo chamado, por exemplo, <code>GeradorListaNumerada.desktop</code> na sua área de trabalho (<code>~/Área de Trabalho</code> ou <code>~/Desktop</code>):</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode numberSource ini number-lines code-with-copy"><code class="sourceCode ini"><span id="cb21-1"><a></a><span class="kw">[Desktop Entry]</span></span>
<span id="cb21-2"><a></a><span class="dt">Version</span><span class="ot">=</span><span class="fl">1.0</span></span>
<span id="cb21-3"><a></a><span class="dt">Type</span><span class="ot">=</span><span class="st">Application</span></span>
<span id="cb21-4"><a></a><span class="dt">Name</span><span class="ot">=</span><span class="st">Gerador Lista Numerada</span></span>
<span id="cb21-5"><a></a><span class="dt">Comment</span><span class="ot">=</span><span class="st">Gera uma lista numerada a partir da área de transferência</span></span>
<span id="cb21-6"><a></a><span class="dt">Exec</span><span class="ot">=</span><span class="st">gerador-lista-numerada</span></span>
<span id="cb21-7"><a></a><span class="dt">Icon</span><span class="ot">=</span><span class="st">/caminho/para/um/icone.png</span></span>
<span id="cb21-8"><a></a><span class="dt">Terminal</span><span class="ot">=</span><span class="kw">false</span></span>
<span id="cb21-9"><a></a><span class="dt">Categories</span><span class="ot">=</span><span class="st">Utility;</span></span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<ul>
<li><strong>Exec</strong>: o comando instalado pelo seu script (<code>gerador-lista-numerada</code>).</li>
<li><strong>Icon</strong>: caminho para um arquivo de ícone (PNG, SVG, etc). Você pode usar um ícone próprio ou algum do sistema.</li>
<li><strong>Terminal</strong>: coloque <code>true</code> se quiser que abra um terminal, ou <code>false</code> para rodar em segundo plano.</li>
</ul>
</div>
</div>
</div>
</div>
</section>
<section id="section-55" class="slide level2">
<h2></h2>
<div title="GitHub Copilot _(continuação)_">
<div class="callout callout-note no-icon callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<p><strong>GitHub Copilot <em>(continuação)</em></strong></p>
</div>
<div class="callout-content">
<p><strong>2. Torne o atalho executável</strong></p>
<p>No terminal, rode:</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb22-1"><a></a><span class="fu">chmod</span> +x ~/Área\ de\ Trabalho/GeradorListaNumerada.desktop</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p><strong>3. (Opcional) Escolha um ícone</strong></p>
<p>Se não tiver um ícone, pode baixar um PNG ou usar algum já presente no sistema, como <code>/usr/share/icons/hicolor/48x48/apps/accessories-text-editor.png</code>.</p>
<hr>
<p>Agora, basta clicar duas vezes no ícone para executar o programa!<br>
Se aparecer um aviso de segurança, clique em “Confiar” ou “Permitir execução”.</p>
</div>
</div>
</div>
</div>
</section>
<section id="section-56" class="slide level2">
<h2></h2>
<p>Aqui tive que fazer outra adaptação para rodar no notebook.</p>
<ul>
<li class="fragment">Referente ao caminho do executável que precisa ser completo no Ubuntu mais recente.</li>
</ul>
<div class="fragment">
<p>No final das contas utilizei esse arquivo <code>GeradorListaNumerada.desktop</code>:</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode numberSource ini number-lines code-with-copy"><code class="sourceCode ini"><span id="cb23-1"><a></a><span class="kw">[Desktop Entry]</span></span>
<span id="cb23-2"><a></a><span class="dt">Version</span><span class="ot">=</span><span class="fl">1.0</span></span>
<span id="cb23-3"><a></a><span class="dt">Type</span><span class="ot">=</span><span class="st">Application</span></span>
<span id="cb23-4"><a></a><span class="dt">Name</span><span class="ot">=</span><span class="st">Gerador Lista Numerada</span></span>
<span id="cb23-5"><a></a><span class="dt">Comment</span><span class="ot">=</span><span class="st">Gera uma lista numerada a partir da área de transferência</span></span>
<span id="cb23-6"><a></a><span class="dt">Exec</span><span class="ot">=</span><span class="st">/home/julio/.local/bin/gerador-lista-numerada</span></span>
<span id="cb23-7"><a></a><span class="dt">Icon</span><span class="ot">=</span><span class="st">/home/julio/Área de trabalho/icone.png</span></span>
<span id="cb23-8"><a></a><span class="dt">Terminal</span><span class="ot">=</span><span class="kw">false</span></span>
<span id="cb23-9"><a></a><span class="dt">Categories</span><span class="ot">=</span><span class="st">Utility;</span></span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="section-57" class="slide level2">
<h2></h2>
<p>Bacana! Temos agora um programa disponível na área de trabalho.</p>
<ul>
<li class="fragment">Ficou muito mais rápido gerar a lista numerada.</li>
</ul>
<div class="fragment">
<p>Poderíamos melhorar nosso programa dando algum retorno de que ele foi executado com sucesso.</p>
<ul>
<li class="fragment">E, claro, para criar o atalho na Área de Trabalho do Windows o processo seria diferente.</li>
</ul>
</div>
</section>
<section id="section-58" class="slide level2">
<h2></h2>
<p>Poderíamos também pensar em outros exemplos de programas com abordagem parecida:</p>
<ul>
<li class="fragment">Copiar duas colunas de uma planilha contendo e-mail e nota dos alunos e gerar texto para um e-mail para a secretaria informando o número de aprovados e reprovados.</li>
<li class="fragment">Copiar trechos do arquivo PDF da Resolução CEPE 473 e acertar as quebras de linha.</li>
</ul>
<div class="fragment">
<p>Mas vamos tratar outra demanda tediosa agora.</p>
</div>
</section></section>
<section>
<section id="exemplo-2-adicionando-capas-a-arquivos-pdf" class="title-slide slide level1 center" data-background-color="#40666e">
<h1>Exemplo 2: Adicionando capas a arquivos PDF</h1>

</section>
<section id="section-59" class="slide level2">
<h2></h2>
<p>Vamos voltar ao cenário comentado no início da aula.</p>
<ul>
<li class="fragment">Suponha que temos 100 arquivos PDF, cada um com um relatório diferente.</li>
<li class="fragment">E que precisamos adicionar uma capa personalizada a cada um desses arquivos.</li>
</ul>
<div class="fragment">
<p>Primeiramente, vale ressaltar que não é possível ler arquivos PDF da mesma forma que lemos arquivos texto e CSV.</p>
<ul>
<li class="fragment">Arquivos PDF, do Word, Excel, etc., possuem uma estrutura interna diferente.</li>
</ul>
</div>
</section>
<section id="section-60" class="slide level2">
<h2></h2>
<p>O arquivo <a href="dados/AulaT6-ex2.zip">AulaT6-ex2.zip</a> contém duas pastas:</p>
<ul>
<li class="fragment"><code>capas</code>: com as 100 capas individuais em PDF.</li>
<li class="fragment"><code>relatorios</code>: com os 100 relatórios individuais também em PDF.</li>
</ul>
<div class="fragment">
<p>Poderíamos usar algum software, como o Adobe Acrobat, para fazer isso manualmente.</p>
<ul>
<li class="fragment">Mas imagina a trabalheira que daria.</li>
<li class="fragment">Em vez disso, vamos pedir ao Copilot para criar uma ferramenta que faça isso para nós.</li>
</ul>
</div>
</section>
<section id="section-61" class="slide level2">
<h2></h2>
<p>Antes de pedirmos o Copilot para criar a ferramenta completa,</p>
<ul>
<li class="fragment">vamos explorar como podemos lidar com a junção (<em>merge</em>) de arquivos PDF em Python.</li>
</ul>
<div class="fragment">
<div title="Prompt">
<div class="callout callout-caution no-icon callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<p><strong>Prompt</strong></p>
</div>
<div class="callout-content">
<p>Eu gostaria de escrever um programa em Python que junte dois arquivos PDF em um só. Como posso fazer isso?</p>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="section-62" class="slide level2">
<h2></h2>
<div title="GitHub Copilot">
<div class="callout callout-note no-icon callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<p><strong>GitHub Copilot</strong></p>
</div>
<div class="callout-content">
<p>Você pode usar a biblioteca <code>PyPDF2</code> para juntar dois arquivos PDF em Python. Veja um exemplo simples:</p>
<ol type="1">
<li>Instale a biblioteca (caso ainda não tenha):</li>
</ol>
<div class="sourceCode" id="cb24"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb24-1"><a></a><span class="ex">pip</span> install PyPDF2</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<ol start="2" type="1">
<li>Código para juntar dois PDFs:</li>
</ol>
<div class="sourceCode" id="cb25"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb25-1"><a></a><span class="im">from</span> PyPDF2 <span class="im">import</span> PdfMerger</span>
<span id="cb25-2"><a></a></span>
<span id="cb25-3"><a></a><span class="co"># Lista dos arquivos PDF a serem unidos</span></span>
<span id="cb25-4"><a></a>arquivos <span class="op">=</span> [<span class="st">'arquivo1.pdf'</span>, <span class="st">'arquivo2.pdf'</span>]</span>
<span id="cb25-5"><a></a></span>
<span id="cb25-6"><a></a>merger <span class="op">=</span> PdfMerger()</span>
<span id="cb25-7"><a></a><span class="cf">for</span> pdf <span class="kw">in</span> arquivos:</span>
<span id="cb25-8"><a></a>    merger.append(pdf)</span>
<span id="cb25-9"><a></a>merger.write(<span class="st">'pdf_unido.pdf'</span>)</span>
<span id="cb25-10"><a></a>merger.close()</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Basta substituir <code>'arquivo1.pdf'</code> e <code>'arquivo2.pdf'</code> pelos nomes dos seus arquivos. O resultado será salvo como <code>pdf_unido.pdf</code>.</p>
</div>
</div>
</div>
</div>
</section>
<section id="section-63" class="slide level2">
<h2></h2>
<p>Já temos então uma opção que parece atender o que precisamos.</p>
<ul>
<li class="fragment">Mas vamos explorar se existe alguma opção com módulo <em>built-in</em>.</li>
</ul>
<div class="fragment">
<div title="Prompt">
<div class="callout callout-caution no-icon callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<p><strong>Prompt</strong></p>
</div>
<div class="callout-content">
<p>Existe alguma forma de fazer isso sem precisar instalar um módulo Python?</p>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="section-64" class="slide level2">
<h2></h2>
<div title="GitHub Copilot">
<div class="callout callout-note no-icon callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<p><strong>GitHub Copilot</strong></p>
</div>
<div class="callout-content">
<p>Não existe uma forma nativa em Python puro para manipular ou juntar arquivos PDF, pois o formato PDF é complexo e não é suportado pela biblioteca padrão do Python.</p>
<p>Se você não quiser instalar módulos Python, pode usar ferramentas externas já instaladas no Linux, como o <code>pdftk</code> ou o <code>qpdf</code>. Por exemplo, usando o terminal:</p>
<p><strong>Com <code>pdftk</code>:</strong></p>
<div class="sourceCode" id="cb26"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb26-1"><a></a><span class="ex">pdftk</span> arquivo1.pdf arquivo2.pdf cat output pdf_unido.pdf</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p><strong>Com <code>qpdf</code>:</strong></p>
<div class="sourceCode" id="cb27"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb27-1"><a></a><span class="ex">qpdf</span> <span class="at">--empty</span> <span class="at">--pages</span> arquivo1.pdf arquivo2.pdf <span class="at">--</span> pdf_unido.pdf</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Essas ferramentas precisam estar instaladas no seu sistema, mas não exigem instalar módulos Python. Se preferir uma solução 100% Python, será necessário instalar um módulo como o <code>PyPDF2</code>.</p>
</div>
</div>
</div>
</div>
</section>
<section id="section-65" class="slide level2">
<h2></h2>
<p>Bom, a solução apresentada depende da instalação de programas externos, o que parece mais complicado do que instalar um módulo Python.</p>
<ul>
<li class="fragment">Obs.: no livro, o Copilot sugeriu criar um script Python que no final das contas usava esses programas.</li>
</ul>
<div class="fragment">
<p>A primeira opção parece boa, mas vamos explorar se existem alternativas.</p>
</div>
<div class="fragment">
<div title="Prompt">
<div class="callout callout-caution no-icon callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<p><strong>Prompt</strong></p>
</div>
<div class="callout-content">
<p>Existem outros módulos Python que eu deveria considerar para tratar essa tarefa?</p>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="section-66" class="slide level2">
<h2></h2>
<div title="GitHub Copilot">
<div class="callout callout-note no-icon callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<p><strong>GitHub Copilot</strong></p>
</div>
<div class="callout-content">
<p>Sim! Além do <strong>PyPDF2</strong>, você pode considerar outros módulos Python para manipulação de PDFs:</p>
<ul>
<li><strong>pypdf</strong>: É uma continuação moderna do PyPDF2, com mais recursos e manutenção ativa.</li>
<li><strong>PyMuPDF (fitz)</strong>: Muito rápido e poderoso, permite manipular, mesclar, dividir e até extrair texto e imagens de PDFs.</li>
<li><strong>pdfminer.six</strong>: Focado em extração de texto, mas também pode manipular PDFs em alguns casos.</li>
<li><strong>pdfrw</strong>: Permite ler e escrever PDFs, além de mesclar e dividir arquivos.</li>
</ul>
<p>Para tarefas simples de juntar PDFs, <strong>pypdf</strong> e <strong>PyMuPDF</strong> são ótimas opções. Exemplo com pypdf:</p>
<div class="sourceCode" id="cb28"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb28-1"><a></a><span class="im">from</span> pypdf <span class="im">import</span> PdfMerger</span>
<span id="cb28-2"><a></a></span>
<span id="cb28-3"><a></a>merger <span class="op">=</span> PdfMerger()</span>
<span id="cb28-4"><a></a>merger.append(<span class="st">"arquivo1.pdf"</span>)</span>
<span id="cb28-5"><a></a>merger.append(<span class="st">"arquivo2.pdf"</span>)</span>
<span id="cb28-6"><a></a>merger.write(<span class="st">"pdf_unido.pdf"</span>)</span>
<span id="cb28-7"><a></a>merger.close()</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Escolha o módulo conforme suas necessidades e preferências!</p>
</div>
</div>
</div>
</div>
</section>
<section id="section-67" class="slide level2">
<h2></h2>
<p>A resposta do Copilot nos mostrou que existe um módulo mais moderno que o <code>PyPDF2</code>, o <code>pypdf</code>.</p>
<ul>
<li class="fragment">E cujo exemplo de código parece bem simples.</li>
</ul>
<div class="fragment">
<p>Mas antes de seguirmos com o <code>pypdf</code>, vamos entender melhor os prós e contras de cada módulo sugerido.</p>
</div>
<div class="fragment">
<div title="Prompt">
<div class="callout callout-caution no-icon callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<p><strong>Prompt</strong></p>
</div>
<div class="callout-content">
<p>Quais são os prós e contras de cada um desses módulos?</p>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="section-68" class="slide level2">
<h2></h2>
<div title="GitHub Copilot _(início)_">
<div class="callout callout-note no-icon callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<p><strong>GitHub Copilot <em>(início)</em></strong></p>
</div>
<div class="callout-content">
<p>Aqui está um resumo dos prós e contras dos principais módulos Python para manipulação de PDFs:</p>
<hr>
<p><strong>1. PyPDF2</strong></p>
<p><strong>Prós:</strong></p>
<ul>
<li>Fácil de usar para tarefas básicas (juntar, dividir, rotacionar).</li>
<li>Bastante documentado e com muitos exemplos.</li>
<li>Não depende de bibliotecas externas.</li>
</ul>
<p><strong>Contras:</strong></p>
<ul>
<li>Desenvolvimento desacelerado (pode estar desatualizado).</li>
<li>Suporte limitado para PDFs complexos ou protegidos.</li>
<li>Algumas funções avançadas podem não funcionar corretamente.</li>
</ul>
</div>
</div>
</div>
</div>
</section>
<section id="section-69" class="slide level2">
<h2></h2>
<div title="GitHub Copilot _(continuação)_">
<div class="callout callout-note no-icon callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<p><strong>GitHub Copilot <em>(continuação)</em></strong></p>
</div>
<div class="callout-content">
<p><strong>2. pypdf</strong></p>
<p><strong>Prós:</strong></p>
<ul>
<li>Continuação moderna do PyPDF2, com manutenção ativa.</li>
<li>Interface semelhante ao PyPDF2, facilitando a migração.</li>
<li>Corrige bugs e adiciona novos recursos.</li>
<li>Boa documentação.</li>
</ul>
<p><strong>Contras:</strong></p>
<ul>
<li>Ainda pode ter limitações com PDFs muito complexos.</li>
<li>Algumas funções avançadas podem não estar presentes.</li>
</ul>
</div>
</div>
</div>
</div>
</section>
<section id="section-70" class="slide level2">
<h2></h2>
<div title="GitHub Copilot _(continuação)_">
<div class="callout callout-note no-icon callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<p><strong>GitHub Copilot <em>(continuação)</em></strong></p>
</div>
<div class="callout-content">
<p><strong>3. PyMuPDF (fitz)</strong></p>
<p><strong>Prós:</strong></p>
<ul>
<li>Muito rápido e eficiente.</li>
<li>Suporte avançado para manipulação de páginas, extração de texto, imagens e metadados.</li>
<li>Suporta PDFs complexos e outros formatos (XPS, EPUB).</li>
<li>Documentação detalhada.</li>
</ul>
<p><strong>Contras:</strong></p>
<ul>
<li>API um pouco mais complexa para tarefas simples.</li>
<li>Pode ser mais pesado para instalar (depende de bibliotecas C).</li>
</ul>
</div>
</div>
</div>
</div>
</section>
<section id="section-71" class="slide level2">
<h2></h2>
<div title="GitHub Copilot _(continuação)_">
<div class="callout callout-note no-icon callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<p><strong>GitHub Copilot <em>(continuação)</em></strong></p>
</div>
<div class="callout-content">
<p><strong>4. pdfrw</strong></p>
<p><strong>Prós:</strong></p>
<ul>
<li>Leve e puro Python.</li>
<li>Permite mesclar, dividir e modificar PDFs.</li>
<li>Útil para manipulação de formulários PDF.</li>
</ul>
<p><strong>Contras:</strong></p>
<ul>
<li>Menos mantido e atualizado.</li>
<li>Suporte limitado para PDFs complexos.</li>
<li>Documentação menos detalhada.</li>
</ul>
</div>
</div>
</div>
</div>
</section>
<section id="section-72" class="slide level2">
<h2></h2>
<div title="GitHub Copilot _(continuação)_">
<div class="callout callout-note no-icon callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<p><strong>GitHub Copilot <em>(continuação)</em></strong></p>
</div>
<div class="callout-content">
<p><strong>5. pdfminer.six</strong></p>
<p><strong>Prós:</strong></p>
<ul>
<li>Excelente para extração de texto detalhada.</li>
<li>Suporta PDFs complexos e multilíngues.</li>
</ul>
<p><strong>Contras:</strong></p>
<ul>
<li>Não é focado em manipulação (juntar/dividir) de PDFs.</li>
<li>API mais complexa para tarefas simples de manipulação.</li>
</ul>
<hr>
<p><strong>Resumo:</strong></p>
<ul>
<li>Para juntar/dividir PDFs: <strong>pypdf</strong> ou <strong>PyMuPDF</strong> são as melhores opções.</li>
<li>Para extração de texto: <strong>pdfminer.six</strong> ou <strong>PyMuPDF</strong>.</li>
<li>Para manipulação leve e sem dependências: <strong>pdfrw</strong>.</li>
</ul>
<p>Escolha conforme sua necessidade!</p>
</div>
</div>
</div>
</div>
</section>
<section id="section-73" class="slide level2">
<h2></h2>
<p>A resposta do Copilot nos ajudou a entender melhor as opções.</p>
<ul>
<li class="fragment">O <code>pypdf</code> parece ser uma boa escolha, pois é uma versão mais moderna do <code>PyPDF2</code>.</li>
<li class="fragment">E o exemplo de código que ele nos deu é bem simples.</li>
</ul>
<div class="fragment">
<p>Vamos partir para a criação da ferramenta.</p>
<ul>
<li class="fragment">Vamos definir a assinatura da função e a docstring com o que queremos.</li>
</ul>
</div>
</section>
<section id="section-74" class="slide level2">
<h2></h2>
<div class="callout callout-tip callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>Dica</strong></p>
</div>
<div class="callout-content">
<p>Antes de continuarmos, vale a pena chamar a atenção para <span class="alert">cuidados</span> que devemos tomar <strong>ao fazer automatizações que lidam com arquivos</strong>.</p>
<p>Se a ferramenta que criarmos estiver incorreta, podemos perder arquivos em nosso computador. Algumas dicas são:</p>
<ul>
<li class="fragment">Sempre trabalhar com cópias dos arquivos, nunca com os originais.</li>
<li class="fragment">Verifique se os arquivos que a ferramenta vai processar estão corretos.
<ul>
<li class="fragment">Ex.: podemos comentar as linhas que manipulam os arquivos e imprimir os nomes dos arquivos que seriam processados.</li>
<li class="fragment">Assim conseguimos conferir se são realmente os arquivos que pretendemos usar.</li>
</ul></li>
<li class="fragment">Sempre fazer testes com poucos arquivos, antes de rodar a ferramenta com todos os arquivos.</li>
</ul>
</div>
</div>
</div>
</section>
<section id="section-75" class="slide level2">
<h2></h2>
<p>Para definirmos a assinatura da função, veja que precisaremos de três parâmetros:</p>
<ul>
<li class="fragment">as pastas das capas, dos relatórios e de onde queremos colocar os arquivos gerados.</li>
</ul>
<div class="fragment">
<p>Também precisaremos explicar o padrão de nomes dos arquivos.</p>
<ul>
<li class="fragment">Para que o Copilot gera um código que junte a capa correta com o relatório correto.</li>
</ul>
</div>
<div class="fragment">
<p>E podemos importar a bibliteca <code>pypdf</code> que já sabemos que vamos usar.</p>
</div>
</section>
<section id="section-76" class="slide level2">
<h2></h2>
<p>Lembre-se também que precisamos seguir o mesmo procedimento do exemplo anterior para criar o ambiente virtual e instalar o módulo <code>pypdf</code>.</p>
<div class="fragment">
<div class="sourceCode" id="cb29"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb29-1"><a aria-hidden="true" tabindex="-1"></a><span class="ex">python3</span> <span class="at">-m</span> venv venv</span>
<span id="cb29-2"><a aria-hidden="true" tabindex="-1"></a><span class="bu">source</span> venv/bin/activate</span>
<span id="cb29-3"><a aria-hidden="true" tabindex="-1"></a><span class="ex">pip</span> install pypdf</span>
<span id="cb29-4"><a aria-hidden="true" tabindex="-1"></a><span class="ex">pip</span> freeze <span class="op">&gt;</span> requirements.txt</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="fragment">
<p>Lembre-se também de configurar o VS Code para usar o Python do ambiente virtual.</p>
</div>
</section>
<section id="section-77" class="slide level2">
<h2></h2>
<p>Vamos então criar um arquivo Python e definir a assinatura da função e a docstring.</p>
<div class="r-fit-text">
<div class="sourceCode" id="cb30"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb30-1"><a></a><span class="im">import</span> pypdf</span>
<span id="cb30-2"><a></a></span>
<span id="cb30-3"><a></a><span class="kw">def</span> adicionar_capas_a_pdfs(pasta_capas, pasta_relatorios, pasta_saida):</span>
<span id="cb30-4"><a></a>    <span class="co">"""</span></span>
<span id="cb30-5"><a></a><span class="co">    Adiciona capas personalizadas a arquivos PDF de relatórios.</span></span>
<span id="cb30-6"><a></a></span>
<span id="cb30-7"><a></a><span class="co">    Parâmetros:</span></span>
<span id="cb30-8"><a></a><span class="co">    - pasta_capas: Caminho da pasta contendo os arquivos PDF das capas.</span></span>
<span id="cb30-9"><a></a><span class="co">      Os arquivos têm nome cover1.pdf, cover2.pdf, etc.</span></span>
<span id="cb30-10"><a></a><span class="co">    - pasta_relatorios: Caminho da pasta contendo os arquivos PDF dos relatórios.</span></span>
<span id="cb30-11"><a></a><span class="co">      Os arquivos têm nome 1.pdf, 2.pdf, etc.</span></span>
<span id="cb30-12"><a></a><span class="co">    - pasta_saida: Caminho da pasta onde os arquivos PDF resultantes serão salvos.</span></span>
<span id="cb30-13"><a></a></span>
<span id="cb30-14"><a></a><span class="co">    A função lê cada arquivo de capa e o respectivo relatório,</span></span>
<span id="cb30-15"><a></a><span class="co">    junta os dois em um único arquivo PDF e salva na pasta de saída.</span></span>
<span id="cb30-16"><a></a><span class="co">    """</span></span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="section-78" class="slide level2">
<h2></h2>
<p>Esse foi o código gerado pelo Copilot no meu caso.</p>
<div class="r-fit-text">
<div class="sourceCode" id="cb31"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb31-1"><a></a><span class="im">import</span> pypdf</span>
<span id="cb31-2"><a></a></span>
<span id="cb31-3"><a></a><span class="kw">def</span> adicionar_capas_a_pdfs(pasta_capas, pasta_relatorios, pasta_saida):</span>
<span id="cb31-4"><a></a>    <span class="co">"""</span></span>
<span id="cb31-5"><a></a><span class="co">    Adiciona capas personalizadas a arquivos PDF de relatórios.</span></span>
<span id="cb31-6"><a></a></span>
<span id="cb31-7"><a></a><span class="co">    Parâmetros:</span></span>
<span id="cb31-8"><a></a><span class="co">    - pasta_capas: Caminho da pasta contendo os arquivos PDF das capas.</span></span>
<span id="cb31-9"><a></a><span class="co">      Os arquivos têm nome cover1.pdf, cover2.pdf, etc.</span></span>
<span id="cb31-10"><a></a><span class="co">    - pasta_relatorios: Caminho da pasta contendo os arquivos PDF dos relatórios.</span></span>
<span id="cb31-11"><a></a><span class="co">      Os arquivos têm nome 1.pdf, 2.pdf, etc.</span></span>
<span id="cb31-12"><a></a><span class="co">    - pasta_saida: Caminho da pasta onde os arquivos PDF resultantes serão salvos.</span></span>
<span id="cb31-13"><a></a></span>
<span id="cb31-14"><a></a><span class="co">    A função lê cada arquivo de capa e o respectivo relatório,</span></span>
<span id="cb31-15"><a></a><span class="co">    junta os dois em um único arquivo PDF e salva na pasta de saída.</span></span>
<span id="cb31-16"><a></a><span class="co">    """</span></span>
<span id="cb31-17"><a></a>    <span class="im">import</span> os</span>
<span id="cb31-18"><a></a></span>
<span id="cb31-19"><a></a>    <span class="co"># Lista os arquivos de capa e relatório</span></span>
<span id="cb31-20"><a></a>    capas <span class="op">=</span> <span class="bu">sorted</span>([f <span class="cf">for</span> f <span class="kw">in</span> os.listdir(pasta_capas) <span class="cf">if</span> f.startswith(<span class="st">'cover'</span>) <span class="kw">and</span> f.endswith(<span class="st">'.pdf'</span>)])</span>
<span id="cb31-21"><a></a>    relatorios <span class="op">=</span> <span class="bu">sorted</span>([f <span class="cf">for</span> f <span class="kw">in</span> os.listdir(pasta_relatorios) <span class="cf">if</span> f.endswith(<span class="st">'.pdf'</span>)])</span>
<span id="cb31-22"><a></a></span>
<span id="cb31-23"><a></a>    <span class="co"># Verifica se o número de capas e relatórios é o mesmo</span></span>
<span id="cb31-24"><a></a>    <span class="cf">if</span> <span class="bu">len</span>(capas) <span class="op">!=</span> <span class="bu">len</span>(relatorios):</span>
<span id="cb31-25"><a></a>        <span class="cf">raise</span> <span class="pp">ValueError</span>(<span class="st">"O número de capas e relatórios deve ser o mesmo."</span>)</span>
<span id="cb31-26"><a></a></span>
<span id="cb31-27"><a></a>    <span class="cf">for</span> capa, relatorio <span class="kw">in</span> <span class="bu">zip</span>(capas, relatorios):</span>
<span id="cb31-28"><a></a>        caminho_capa <span class="op">=</span> os.path.join(pasta_capas, capa)</span>
<span id="cb31-29"><a></a>        caminho_relatorio <span class="op">=</span> os.path.join(pasta_relatorios, relatorio)</span>
<span id="cb31-30"><a></a>        caminho_saida <span class="op">=</span> os.path.join(pasta_saida, relatorio)</span>
<span id="cb31-31"><a></a></span>
<span id="cb31-32"><a></a>        <span class="co"># Lê os arquivos PDF</span></span>
<span id="cb31-33"><a></a>        leitor_capa <span class="op">=</span> pypdf.PdfReader(caminho_capa)</span>
<span id="cb31-34"><a></a>        leitor_relatorio <span class="op">=</span> pypdf.PdfReader(caminho_relatorio)</span>
<span id="cb31-35"><a></a></span>
<span id="cb31-36"><a></a>        escritor_pdf <span class="op">=</span> pypdf.PdfWriter()</span>
<span id="cb31-37"><a></a></span>
<span id="cb31-38"><a></a>        <span class="co"># Adiciona a capa</span></span>
<span id="cb31-39"><a></a>        <span class="cf">for</span> pagina <span class="kw">in</span> leitor_capa.pages:</span>
<span id="cb31-40"><a></a>            escritor_pdf.add_page(pagina)</span>
<span id="cb31-41"><a></a></span>
<span id="cb31-42"><a></a>        <span class="co"># Adiciona o relatório</span></span>
<span id="cb31-43"><a></a>        <span class="cf">for</span> pagina <span class="kw">in</span> leitor_relatorio.pages:</span>
<span id="cb31-44"><a></a>            escritor_pdf.add_page(pagina)</span>
<span id="cb31-45"><a></a></span>
<span id="cb31-46"><a></a>        <span class="co"># Salva o novo arquivo PDF com a capa adicionada</span></span>
<span id="cb31-47"><a></a>        <span class="cf">with</span> <span class="bu">open</span>(caminho_saida, <span class="st">'wb'</span>) <span class="im">as</span> arquivo_saida:</span>
<span id="cb31-48"><a></a>            escritor_pdf.write(arquivo_saida)</span>
<span id="cb31-49"><a></a></span>
<span id="cb31-50"><a></a><span class="co"># Exemplo de uso:</span></span>
<span id="cb31-51"><a></a><span class="co"># adicionar_capas_a_pdfs('pasta_capas', 'pasta_relatorios',</span></span>
<span id="cb31-52"><a></a><span class="co">#                          'pasta_saida')</span></span>
<span id="cb31-53"><a></a></span>
<span id="cb31-54"><a></a><span class="cf">if</span> <span class="va">__name__</span> <span class="op">==</span> <span class="st">"__main__"</span>:</span>
<span id="cb31-55"><a></a>    <span class="co"># Exemplo de uso</span></span>
<span id="cb31-56"><a></a>    adicionar_capas_a_pdfs(<span class="st">'pasta_capas'</span>, <span class="st">'pasta_relatorios'</span>, <span class="st">'pasta_saida'</span>)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="section-79" class="slide level2">
<h2></h2>
<p>Vamos agora copiar as pastas de capas e relatórios para dentro do nosso projeto.</p>
<ul>
<li class="fragment">E criar uma pasta <code>saida</code> vazia para onde os arquivos gerados serão salvos.</li>
<li class="fragment">Precisamos acertar os nomes das pastas no script.</li>
</ul>
<div class="fragment">
<p>Exemplo:</p>
<div class="sourceCode" id="cb32"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb32-1"><a></a><span class="cf">if</span> <span class="va">__name__</span> <span class="op">==</span> <span class="st">"__main__"</span>:</span>
<span id="cb32-2"><a></a>    <span class="co"># Exemplo de uso</span></span>
<span id="cb32-3"><a></a>    adicionar_capas_a_pdfs(<span class="st">'capas'</span>, <span class="st">'relatorios'</span>, <span class="st">'saida'</span>)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="section-80" class="slide level2">
<h2></h2>
<p>Hora de testar o programa!</p>
<ul>
<li class="fragment">Confira, por amostragem, pelo menos 3 arquivos gerados para conferir se deu certo.</li>
</ul>
</section>
<section id="reutilizando-a-ferramenta" class="slide level2">
<h2>Reutilizando a ferramenta</h2>
<p>Vamos supor que essa operação fosse necessária mais vezes.</p>
<ul>
<li class="fragment">E que precisasse ser feita por alguém que não é programador.</li>
<li class="fragment">Que tal pedirmos o Copilot para gerar uma interface gráfica simples para a ferramenta?</li>
</ul>
<div class="fragment">
<div title="Prompt">
<div class="callout callout-caution no-icon callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<p><strong>Prompt</strong></p>
</div>
<div class="callout-content">
<p>Eu gostaria de criar uma interface gráfica simples para essa ferramenta. Pode me ajudar?</p>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="section-81" class="slide level2">
<h2></h2>
<div title="GitHub Copilot _(início)_">
<div class="callout callout-note no-icon callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<p><strong>GitHub Copilot <em>(início)</em></strong></p>
</div>
<div class="callout-content">
<p>Claro! Você pode criar uma interface gráfica simples usando o Tkinter, que já vem com o Python. Vou sugerir um exemplo básico onde o usuário pode selecionar as três pastas (capas, relatórios e saída) e clicar em um botão para executar a função.</p>
<p>Adicione o seguinte código ao final do seu arquivo junta_capas.py:</p>
<div class="sourceCode" id="cb33"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb33-1"><a></a><span class="co"># ...existing code...</span></span>
<span id="cb33-2"><a></a></span>
<span id="cb33-3"><a></a><span class="im">import</span> tkinter <span class="im">as</span> tk</span>
<span id="cb33-4"><a></a><span class="im">from</span> tkinter <span class="im">import</span> filedialog, messagebox</span>
<span id="cb33-5"><a></a></span>
<span id="cb33-6"><a></a><span class="kw">def</span> selecionar_pasta(entry_widget):</span>
<span id="cb33-7"><a></a>    pasta <span class="op">=</span> filedialog.askdirectory()</span>
<span id="cb33-8"><a></a>    <span class="cf">if</span> pasta:</span>
<span id="cb33-9"><a></a>        entry_widget.delete(<span class="dv">0</span>, tk.END)</span>
<span id="cb33-10"><a></a>        entry_widget.insert(<span class="dv">0</span>, pasta)</span>
<span id="cb33-11"><a></a></span>
<span id="cb33-12"><a></a><span class="kw">def</span> executar():</span>
<span id="cb33-13"><a></a>    pasta_capas <span class="op">=</span> entry_capas.get()</span>
<span id="cb33-14"><a></a>    pasta_relatorios <span class="op">=</span> entry_relatorios.get()</span>
<span id="cb33-15"><a></a>    pasta_saida <span class="op">=</span> entry_saida.get()</span>
<span id="cb33-16"><a></a>    <span class="cf">try</span>:</span>
<span id="cb33-17"><a></a>        adicionar_capas_a_pdfs(pasta_capas, pasta_relatorios, pasta_saida)</span>
<span id="cb33-18"><a></a>        messagebox.showinfo(<span class="st">"Sucesso"</span>, <span class="st">"Arquivos gerados com sucesso!"</span>)</span>
<span id="cb33-19"><a></a>    <span class="cf">except</span> <span class="pp">Exception</span> <span class="im">as</span> e:</span>
<span id="cb33-20"><a></a>        messagebox.showerror(<span class="st">"Erro"</span>, <span class="bu">str</span>(e))</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
</section>
<section id="section-82" class="slide level2">
<h2></h2>
<div title="GitHub Copilot _(continuação)_">
<div class="callout callout-note no-icon callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<p><strong>GitHub Copilot <em>(continuação)</em></strong></p>
</div>
<div class="callout-content">
<div class="sourceCode" id="cb34"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb34-1"><a></a><span class="cf">if</span> <span class="va">__name__</span> <span class="op">==</span> <span class="st">"__main__"</span>:</span>
<span id="cb34-2"><a></a>    root <span class="op">=</span> tk.Tk()</span>
<span id="cb34-3"><a></a>    root.title(<span class="st">"Juntar Capas em PDFs"</span>)</span>
<span id="cb34-4"><a></a></span>
<span id="cb34-5"><a></a>    tk.Label(root, text<span class="op">=</span><span class="st">"Pasta das Capas:"</span>).grid(row<span class="op">=</span><span class="dv">0</span>, column<span class="op">=</span><span class="dv">0</span>, sticky<span class="op">=</span><span class="st">"e"</span>)</span>
<span id="cb34-6"><a></a>    entry_capas <span class="op">=</span> tk.Entry(root, width<span class="op">=</span><span class="dv">40</span>)</span>
<span id="cb34-7"><a></a>    entry_capas.grid(row<span class="op">=</span><span class="dv">0</span>, column<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb34-8"><a></a>    tk.Button(root, text<span class="op">=</span><span class="st">"Selecionar"</span>, command<span class="op">=</span><span class="kw">lambda</span>: selecionar_pasta(entry_capas)).grid(row<span class="op">=</span><span class="dv">0</span>, column<span class="op">=</span><span class="dv">2</span>)</span>
<span id="cb34-9"><a></a></span>
<span id="cb34-10"><a></a>    tk.Label(root, text<span class="op">=</span><span class="st">"Pasta dos Relatórios:"</span>).grid(row<span class="op">=</span><span class="dv">1</span>, column<span class="op">=</span><span class="dv">0</span>, sticky<span class="op">=</span><span class="st">"e"</span>)</span>
<span id="cb34-11"><a></a>    entry_relatorios <span class="op">=</span> tk.Entry(root, width<span class="op">=</span><span class="dv">40</span>)</span>
<span id="cb34-12"><a></a>    entry_relatorios.grid(row<span class="op">=</span><span class="dv">1</span>, column<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb34-13"><a></a>    tk.Button(root, text<span class="op">=</span><span class="st">"Selecionar"</span>, command<span class="op">=</span><span class="kw">lambda</span>: selecionar_pasta(entry_relatorios)).grid(row<span class="op">=</span><span class="dv">1</span>, column<span class="op">=</span><span class="dv">2</span>)</span>
<span id="cb34-14"><a></a></span>
<span id="cb34-15"><a></a>    tk.Label(root, text<span class="op">=</span><span class="st">"Pasta de Saída:"</span>).grid(row<span class="op">=</span><span class="dv">2</span>, column<span class="op">=</span><span class="dv">0</span>, sticky<span class="op">=</span><span class="st">"e"</span>)</span>
<span id="cb34-16"><a></a>    entry_saida <span class="op">=</span> tk.Entry(root, width<span class="op">=</span><span class="dv">40</span>)</span>
<span id="cb34-17"><a></a>    entry_saida.grid(row<span class="op">=</span><span class="dv">2</span>, column<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb34-18"><a></a>    tk.Button(root, text<span class="op">=</span><span class="st">"Selecionar"</span>, command<span class="op">=</span><span class="kw">lambda</span>: selecionar_pasta(entry_saida)).grid(row<span class="op">=</span><span class="dv">2</span>, column<span class="op">=</span><span class="dv">2</span>)</span>
<span id="cb34-19"><a></a></span>
<span id="cb34-20"><a></a>    tk.Button(root, text<span class="op">=</span><span class="st">"Executar"</span>, command<span class="op">=</span>executar, width<span class="op">=</span><span class="dv">20</span>).grid(row<span class="op">=</span><span class="dv">3</span>, column<span class="op">=</span><span class="dv">0</span>, columnspan<span class="op">=</span><span class="dv">3</span>, pady<span class="op">=</span><span class="dv">10</span>)</span>
<span id="cb34-21"><a></a></span>
<span id="cb34-22"><a></a>    root.mainloop()</span>
<span id="cb34-23"><a></a><span class="co"># ...existing code...</span></span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
</section>
<section id="section-83" class="slide level2">
<h2></h2>
<div title="GitHub Copilot _(continuação)_">
<div class="callout callout-note no-icon callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<p><strong>GitHub Copilot <em>(continuação)</em></strong></p>
</div>
<div class="callout-content">
<p><strong>Como funciona:</strong></p>
<ul>
<li>O usuário seleciona as três pastas usando os botões “Selecionar”.</li>
<li>Ao clicar em “Executar”, a função é chamada e mostra uma mensagem de sucesso ou erro.</li>
</ul>
<p>Se quiser, pode separar a interface em outro arquivo, mas assim fica tudo em um só. Se precisar de melhorias, é só pedir!</p>
</div>
</div>
</div>
</div>
</section>
<section id="section-84" class="slide level2">
<h2></h2>
<p>Com esse código, temos uma interface gráfica simples, mas bem prática:</p>
<div class="columns">
<div class="column">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="imagens/tela_programa_juntar_capas_pdfs.png" class="quarto-figure quarto-figure-center" style="max-height: 50vh; width: auto;" alt="Tela principal do programa para juntar capas em PDFs."></p>
</figure>
</div>
</div><div class="column">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="imagens/tela_programa_juntar_capas_pdfs_selecionar.png" class="quarto-figure quarto-figure-center" style="max-height: 50vh; width: auto;" alt="Tela para navegar na estrutura de pastas e selecionar uma pasta."></p>
</figure>
</div>
</div></div>
<div class="fragment">
<p>Se quiséssemos poderíamos novamente criar um atalho na área de trabalho para abrir essa interface gráfica.</p>
</div>
</section></section>
<section>
<section id="fluxo-de-trabalho-para-usar-módulos-do-python-com-o-copilot" class="title-slide slide level1 center" data-background-color="#40666e">
<h1>Fluxo de trabalho para usar módulos do Python com o Copilot</h1>

</section>
<section id="section-85" class="slide level2">
<h2></h2>
<p>Após termos feito esses dois exemplos, podemos pensar em um fluxo de trabalho para usar o Copilot na criação de ferramentas que usem módulos do Python.</p>
<ol type="1">
<li class="fragment">Pedir ao Copilot (ou ChatGPT) para listar módulos do Python que podem ser usados para a tarefa de interesse.</li>
<li class="fragment">Perguntar ao Copilot sobre os prós e contras de cada módulo.</li>
<li class="fragment">Escolher o módulo que parece mais adequado.</li>
<li class="fragment">Se necessário, criar um ambiente virtual e instalar o módulo.</li>
<li class="fragment">Seguir o Ciclo de Projeto de Funções que vimos anteriormente, incluindo o módulo escolhido.</li>
<li class="fragment">Se ficarmos travados, tentamos um módulo diferente.</li>
</ol>
</section></section>
<section>
<section id="exemplo-3-interface-para-oficina-de-programação-de-jogos" class="title-slide slide level1 center" data-background-color="#40666e">
<h1>Exemplo 3: Interface para Oficina de Programação de Jogos</h1>

</section>
<section id="section-86" class="slide level2">
<h2></h2>
<p>Nós acabamos de ter o 8º UFLA de Portas Abertas.</p>
<ul>
<li class="fragment">E, dentro do evento, tivemos a Oficina de Programação de Jogos.</li>
</ul>
<div class="fragment">
<p>Nessa oficina, os participantes do evento experimentam, e modificam, jogos implementados como trabalho da disciplina IPOO de Sistemas de Informação.</p>
<ul>
<li class="fragment">E um jogo para ensino de Python, desenvolvido como TCC de Ciência da Computação.</li>
</ul>
</div>
</section>
<section id="section-87" class="slide level2">
<h2></h2>
<p>No evento do ano anterior tínhamos duas dificuldades:</p>
<ul>
<li class="fragment">Deixávamos todos os jogos em todas as máquinas, mas abríamos um jogo em cada máquina alternadamente.
<ul>
<li class="fragment">A ideia era que os participantes percebessem que havia vários jogos.</li>
</ul></li>
<li class="fragment">Depois que os participantes alteravam o código de um jogo, precisávamos restaurar o código original para a próxima turma.</li>
<li class="fragment">Dava uma trabalheira fazer isso na mão.</li>
</ul>
</section>
<section id="section-88" class="slide level2">
<h2></h2>
<p>Usei então o ChatGPT e Copilot para criar uma interface gráfica simples</p>
<ul>
<li class="fragment">que funcionasse como uma tela inicial (<em>launcher</em>) que mostrasse os jogos disponíveis.
<ul>
<li class="fragment">Que permitisse iniciar os jogos ao clicar neles.</li>
</ul></li>
<li class="fragment">E que também tivesse um botão para restaurar o código original do jogo.
<ul>
<li class="fragment">Para isso, usei um repositório git local para cada jogo.</li>
<li class="fragment">Restaurar o jogo era simplesmente rodar o comando <code>git restore .</code> na pasta do jogo.</li>
</ul></li>
</ul>
</section>
<section id="section-89" class="slide level2">
<h2></h2>
<p>Esse foi meu primeiro prompt para o ChatGPT:</p>
<div title="Prompt">
<div class="callout callout-caution no-icon callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<p><strong>Prompt</strong></p>
</div>
<div class="callout-content">
<p>Tenho alguns jogos desenvolvidos em Java usando a IDE Greenfoot que gostaria de utilizar em uma demonstração. A ideia é que a pessoa chegue e jogue os 7 jogos disponíveis no computador. Para jogar cada jogo é necessário abrir o projeto no Greenfoot e executar. Para facilitar esse processo, gostaria de ter uma espécie de “landing page” que mostrasse uma imagem de cada jogo e que, quando o usuário clicasse na imagem, o Greenfoot fosse aberto com o projeto do jogo em questão. Estou usando Linux Ubuntu e creio que para abrir o Greenfoot bastaria executar uma linha de comando passando o caminho do projeto como parâmetro. Essa “landing page” pode ser com qualquer tipo de tecnologia que seja fácil de fazer (pode ser web rodando local, ou uma aplicação Python, enfim, qualquer coisa). Procuro algo simples e rápido de fazer ou alterar.</p>
</div>
</div>
</div>
</div>
</section>
<section id="section-90" class="slide level2">
<h2></h2>
<p>O ChatGPT sugeriu três opções, já com exemplos de código</p>
<ol type="1">
<li class="fragment">Uma página HTML que precisaria ser aberta com Electron ou com um servidor Python para conseguir executar scripts locais.</li>
<li class="fragment">Uma aplicação Python com interface gráfica usando <code>Tkinter</code>.</li>
<li class="fragment">Um menu no terminal para a escolha do jogo.</li>
</ol>
<div class="fragment">
<p>Não entendi porque ele sugeriu a opção 3 🤔</p>
<ul>
<li class="fragment">Mas, enfim, escolhi a opção 2, que me pareceu mais prática.</li>
</ul>
</div>
</section>
<section id="section-91" class="slide level2">
<h2></h2>
<p>Usei o prompt:</p>
<div title="Prompt">
<div class="callout callout-caution no-icon callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<p><strong>Prompt</strong></p>
</div>
<div class="callout-content">
<p>Gostei da opção 2. Mas gostaria que a aplicação fosse aberta maximizada e que as imagens dos jogos ficasse todas do mesmo tamanho em um grid com 2 linhas e 4 colunas</p>
</div>
</div>
</div>
</div>
<div class="fragment">
<p>Não vou colocar todos os prompts aqui, não fiz de forma muito estruturada.</p>
<ul>
<li class="fragment">De um certo ponto em diante passei para o Copilot.</li>
</ul>
</div>
</section>
<section id="section-92" class="slide level2">
<h2></h2>
<p>Mas alguns dos passos foram:</p>
<ul>
<li class="fragment">Foram geradas algumas versões de código que geravam erro (eu colava o erro no ChatGPT).</li>
<li class="fragment">Durante o processo, às vezes aparecia só o primeiro jogo, outra hora o primeiro e o quinto.</li>
<li class="fragment">Quando apareceram todos os jogos, a janela deixou de ficar maximizada.</li>
<li class="fragment">Depois, pedi para substituir um dos espaços de jogo por uma imagem.</li>
<li class="fragment">Pedi que, ao abrir um jogo, a IDE fosse fechada antes (para não deixar várias instâncias em execução).</li>
</ul>
</section>
<section id="section-93" class="slide level2">
<h2></h2>
<p>Mas alguns dos passos foram:</p>
<ul>
<li class="fragment">Acrescentei um dos jogos que era via Godot Engine e não via Greenfoot.</li>
<li class="fragment">Acrescentei o botão para restaurar o código original dos jogos.</li>
</ul>
<div class="fragment">
<p>E esse foi o resultado final…</p>
</div>
</section>
<section id="section-94" class="slide level2">
<h2></h2>
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="imagens/oficina_programacao_jogos.png" class="quarto-figure quarto-figure-center" style="max-height: 50vh; width: auto;" alt="Capa do livro de Potter e Zingaro."></p>
</figure>
</div>
</section>
<section id="section-95" class="slide level2">
<h2></h2>
<p>No dia do evento, ainda tivemos uma surpresa.</p>
<ul>
<li class="fragment">Eu tinha testado o programa em uma máquina do laboratório.
<ul>
<li class="fragment">E como, em tese, todas as máquinas têm a mesma imagem, tudo funcionaria.</li>
</ul></li>
<li class="fragment">Mas ao fazer a instalação pela manhã, vimos que o programa não funcionava em algumas máquinas.
<ul>
<li class="fragment">Por que o módulo <code>tkinter</code> depende de instalação no sistema operacional.</li>
</ul></li>
<li class="fragment">Consegui apoio para fazer a instalação (dependia de senha de administrador).</li>
</ul>
</section>
<section id="section-96" class="slide level2">
<h2></h2>
<p>Mas enquanto estava tentando isso, usei o ChatGPT e ele informou que uma alternativa seria usar o <code>pygame</code>.</p>
<ul>
<li class="fragment">Pois é um módulo Python que não depende de instalação no sistema operacional.</li>
</ul>
<div class="fragment">
<p>Pretendo fazer isso no próximo ano 😉</p>
</div>
</section></section>
<section>
<section id="exemplo-4-juntando-fotos-de-vários-celulares" class="title-slide slide level1 center" data-background-color="#40666e">
<h1>Exemplo 4: Juntando fotos de vários celulares</h1>

</section>
<section id="section-97" class="slide level2">
<h2></h2>
<p>Imagine que queremos juntar fotos dos nossos celulares e de nossos familiares.</p>
<ul>
<li class="fragment">A ideia é ter tudo acessível em um único lugar.</li>
<li class="fragment">Para que todos possam ter acesso a todas as fotos.</li>
<li class="fragment">Mas, provavelmente, existem fotos repetidas, que uma pessoa mandou para outra.
<ul>
<li class="fragment">e não queremos ter fotos repetidas no nosso acervo.</li>
</ul></li>
</ul>
<div class="fragment">
<p>Vamos então criar uma ferramenta que faça isso para nós.</p>
</div>
</section>
<section id="section-98" class="slide level2">
<h2></h2>
<p>Para testar, vamos usar o arquivo <a href="dados/AulaT6-ex4.zip">AulaT6-ex4.zip</a> que contém várias figuras em PNG.</p>
<ul>
<li class="fragment">Existem duas subpastas, <code>figuras1</code> e <code>figuras2</code>, cada uma com várias figuras.</li>
<li class="fragment">Não são fotos reais, mas servem para testar a ferramenta.</li>
</ul>
</section>
<section id="section-99" class="slide level2">
<h2></h2>
<p>A pasta <code>figuras1</code> tem 98 figuras e a pasta <code>figuras2</code> tem 112.</p>
<ul>
<li class="fragment">No total são então 210 figuras, mas 10 são repetidas.
<ul>
<li class="fragment">Por ex.: a figura 1566.png da pasta <code>figuras1</code> é idêntica à figura 2471.png da pasta <code>figuras2</code>.</li>
</ul></li>
<li class="fragment">Portanto, se nossa ferramenta funcionar corretamente, no final teremos 200 figuras.</li>
<li class="fragment">Além disso, devemos tomar cuidado pois podem existir fotos diferentes nas duas pastas mas com o mesmo nome.
<ul>
<li class="fragment">Por ex.: a figura 9595.png da pasta <code>figuras1</code> é diferente da figura 9595.png da pasta <code>figuras2</code>.</li>
<li class="fragment">Nesse caso nós não queremos perder nenhuma das duas, e precisaremos renomear uma delas.</li>
</ul></li>
</ul>
</section>
<section id="section-100" class="slide level2">
<h2></h2>
<p>Para esse exemplo, não vou colocar aqui nos slides o passo a passo completo.</p>
<ul>
<li class="fragment">Vou colocar os prompts usados no livro, mas sem apresentar os resutados do Copilot.</li>
<li class="fragment">Repita os passos no seu computador e teste com o arquivo mencionado.</li>
</ul>
</section>
<section id="section-101" class="slide level2">
<h2></h2>
<div title="Prompt">
<div class="callout callout-caution no-icon callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<p><strong>Prompt</strong></p>
</div>
<div class="callout-content">
<p>Eu preciso escrever um programa em Python que copia arquivos. Como posso fazer isso?</p>
</div>
</div>
</div>
</div>
<ul>
<li class="fragment">A ideia de copiar arquivos em vez de movê-los é para evitar perda de dados.</li>
</ul>
<div class="fragment">
<div title="Prompt">
<div class="callout callout-caution no-icon callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<p><strong>Prompt</strong></p>
</div>
<div class="callout-content">
<p>O módulo <code>shutil</code> precisa ser instalado?</p>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="section-102" class="slide level2">
<h2></h2>
<div title="Prompt">
<div class="callout callout-caution no-icon callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<p><strong>Prompt</strong></p>
</div>
<div class="callout-content">
<p>Como eu posso descobrir se dois arquivos PNG são idênticos usando Python?</p>
</div>
</div>
</div>
</div>
<div class="fragment">
<div title="Prompt">
<div class="callout callout-caution no-icon callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<p><strong>Prompt</strong></p>
</div>
<div class="callout-content">
<p>E se eu tiver centenas de arquivos PNG e quiser encontrar arquivos duplicados? Essa abordagem ainda funciona?</p>
</div>
</div>
</div>
</div>
</div>
<div class="fragment">
<div title="Prompt">
<div class="callout callout-caution no-icon callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<p><strong>Prompt</strong></p>
</div>
<div class="callout-content">
<p>Como eu posso descobrir se dois arquivos PNG são idênticos usando Python?</p>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="section-103" class="slide level2">
<h2></h2>
<p>A partir daí os autores livro usam <span class="alert">decomposição de problemas</span> para criar a ferramenta.</p>
<ul>
<li class="fragment">A ideia é criar uma ferramenta mais genérica de forma que possa ser usada em mais situações.</li>
<li class="fragment">Por exemplo, ela poderia receber várias pastas de figuras e não apenas duas.</li>
<li class="fragment">E poderia copiar as fotos para uma pasta de destino,
<ul>
<li class="fragment">sempre verificando se a foto já existe lá (para evitar duplicatas).</li>
</ul></li>
</ul>
</section>
<section id="section-104" class="slide level2">
<h2></h2>
<p>Os autores, usando <strong><em>design top-down</em></strong>, definem então as funções abaixo.</p>
<ol type="1">
<li class="fragment">Fazer cópias de vários arquivos em uma pasta de destino, apenas se ele não for duplicado.</li>
<li class="fragment">Fazer cópia de um arquivo em uma pasta de destino, apenas se ele não for duplicado.</li>
<li class="fragment">Obter um bom nome para o arquivo copiado (para evitar perda de dados com conflito de nomes).</li>
</ol>
</section>
<section id="section-105" class="slide level2">
<h2></h2>
<p>Essas são as assinaturas e docstrings das funções usadas no livro.</p>
<ul>
<li class="fragment">Como já vimos antes, na hora de implementar seguimos o caminho <em>bottom-up</em>.</li>
<li class="fragment">Portanto, será apresentada primeira a 3ª função, depois a 2ª e por fim a 1ª.</li>
</ul>
</section>
<section id="section-106" class="slide level2">
<h2></h2>
<div class="sourceCode" id="cb35"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb35-1"><a></a><span class="kw">def</span> obter_bom_nome_arquivo(caminho_arquivo):</span>
<span id="cb35-2"><a></a>    <span class="co">"""</span></span>
<span id="cb35-3"><a></a><span class="co">    caminho_arquivo é o nome de um arquivo PNG.</span></span>
<span id="cb35-4"><a></a></span>
<span id="cb35-5"><a></a><span class="co">    Enquanto o arquivo caminho_arquivo existir, acrescenta</span></span>
<span id="cb35-6"><a></a><span class="co">    um caractere _ logo antes do .png e retorna o novo nome.</span></span>
<span id="cb35-7"><a></a><span class="co">    Ex.: 9595.png se torna 9595_.png.</span></span>
<span id="cb35-8"><a></a></span>
<span id="cb35-9"><a></a><span class="co">    Retorna o nome resultante do arquivo.</span></span>
<span id="cb35-10"><a></a><span class="co">    """</span></span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="section-107" class="slide level2">
<h2></h2>
<div class="sourceCode" id="cb36"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb36-1"><a></a><span class="kw">def</span> fazer_copia(caminho_arquivo, pasta_destino):</span>
<span id="cb36-2"><a></a>    <span class="co">"""</span></span>
<span id="cb36-3"><a></a><span class="co">    """</span></span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="section-108" class="slide level2">
<h2></h2>
<div class="sourceCode" id="cb37"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb37-1"><a></a><span class="kw">def</span> fazer_varias_copias(pastas, pasta_destino):</span>
<span id="cb37-2"><a></a>    <span class="co">"""</span></span>
<span id="cb37-3"><a></a><span class="co">    </span></span>
<span id="cb37-4"><a></a><span class="co">    """</span></span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>


</section></section>
    </div>
  <div class="quarto-auto-generated-content" style="display: none;">
<p><img src="imagens/logo_UFLA.png" class="slide-logo"></p>
<div class="footer footer-default">

</div>
</div></div>

  <script>window.backupDefine = window.define; window.define = undefined;</script>
  <script src="site_libs/revealjs/dist/reveal.js"></script>
  <!-- reveal.js plugins -->
  <script src="site_libs/revealjs/plugin/quarto-line-highlight/line-highlight.js"></script>
  <script src="site_libs/revealjs/plugin/pdf-export/pdfexport.js"></script>
  <script src="site_libs/revealjs/plugin/reveal-menu/menu.js"></script>
  <script src="site_libs/revealjs/plugin/reveal-menu/quarto-menu.js"></script>
  <script src="site_libs/revealjs/plugin/reveal-chalkboard/plugin.js"></script>
  <script src="site_libs/revealjs/plugin/reveal-pointer/pointer.js"></script>
  <script src="site_libs/revealjs/plugin/quarto-support/support.js"></script>
  

  <script src="site_libs/revealjs/plugin/notes/notes.js"></script>
  <script src="site_libs/revealjs/plugin/search/search.js"></script>
  <script src="site_libs/revealjs/plugin/zoom/zoom.js"></script>
  <script src="site_libs/revealjs/plugin/math/math.js"></script>
  <script>window.define = window.backupDefine; window.backupDefine = undefined;</script>

  <script>

      // Full list of configuration options available at:
      // https://revealjs.com/config/
      Reveal.initialize({
'controlsAuto': true,
'previewLinksAuto': true,
'pdfSeparateFragments': false,
'autoAnimateEasing': "ease",
'autoAnimateDuration': 1,
'autoAnimateUnmatched': true,
'jumpToSlide': true,
'menu': {"side":"left","useTextContentForMissingTitles":true,"markers":false,"loadIcons":false,"custom":[{"title":"Tools","icon":"<i class=\"fas fa-gear\"></i>","content":"<ul class=\"slide-menu-items\">\n<li class=\"slide-tool-item active\" data-item=\"0\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.fullscreen(event)\"><kbd>f</kbd> Fullscreen</a></li>\n<li class=\"slide-tool-item\" data-item=\"1\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.speakerMode(event)\"><kbd>s</kbd> Speaker View</a></li>\n<li class=\"slide-tool-item\" data-item=\"2\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.overview(event)\"><kbd>o</kbd> Slide Overview</a></li>\n<li class=\"slide-tool-item\" data-item=\"3\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.togglePdfExport(event)\"><kbd>e</kbd> PDF Export Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"4\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.toggleScrollView(event)\"><kbd>r</kbd> Scroll View Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"5\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.toggleChalkboard(event)\"><kbd>b</kbd> Toggle Chalkboard</a></li>\n<li class=\"slide-tool-item\" data-item=\"6\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.toggleNotesCanvas(event)\"><kbd>c</kbd> Toggle Notes Canvas</a></li>\n<li class=\"slide-tool-item\" data-item=\"7\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.downloadDrawings(event)\"><kbd>d</kbd> Download Drawings</a></li>\n<li class=\"slide-tool-item\" data-item=\"8\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.keyboardHelp(event)\"><kbd>?</kbd> Keyboard Help</a></li>\n</ul>"}],"openButton":true},
'chalkboard': {"buttons":true},
'pointer': {"key":"q","color":"red","pointerSize":16,"alwaysVisible":false},
'smaller': false,
 
        // Display controls in the bottom right corner
        controls: false,

        // Help the user learn the controls by providing hints, for example by
        // bouncing the down arrow when they first encounter a vertical slide
        controlsTutorial: false,

        // Determines where controls appear, "edges" or "bottom-right"
        controlsLayout: 'edges',

        // Visibility rule for backwards navigation arrows; "faded", "hidden"
        // or "visible"
        controlsBackArrows: 'faded',

        // Display a presentation progress bar
        progress: true,

        // Display the page number of the current slide
        slideNumber: 'c/t',

        // 'all', 'print', or 'speaker'
        showSlideNumber: 'all',

        // Add the current slide number to the URL hash so that reloading the
        // page/copying the URL will return you to the same slide
        hash: true,

        // Start with 1 for the hash rather than 0
        hashOneBasedIndex: false,

        // Flags if we should monitor the hash and change slides accordingly
        respondToHashChanges: true,

        // Push each slide change to the browser history
        history: true,

        // Enable keyboard shortcuts for navigation
        keyboard: true,

        // Enable the slide overview mode
        overview: true,

        // Disables the default reveal.js slide layout (scaling and centering)
        // so that you can use custom CSS layout
        disableLayout: false,

        // Vertical centering of slides
        center: false,

        // Enables touch navigation on devices with touch input
        touch: true,

        // Loop the presentation
        loop: false,

        // Change the presentation direction to be RTL
        rtl: false,

        // see https://revealjs.com/vertical-slides/#navigation-mode
        navigationMode: 'linear',

        // Randomizes the order of slides each time the presentation loads
        shuffle: false,

        // Turns fragments on and off globally
        fragments: true,

        // Flags whether to include the current fragment in the URL,
        // so that reloading brings you to the same fragment position
        fragmentInURL: false,

        // Flags if the presentation is running in an embedded mode,
        // i.e. contained within a limited portion of the screen
        embedded: false,

        // Flags if we should show a help overlay when the questionmark
        // key is pressed
        help: true,

        // Flags if it should be possible to pause the presentation (blackout)
        pause: true,

        // Flags if speaker notes should be visible to all viewers
        showNotes: false,

        // Global override for autoplaying embedded media (null/true/false)
        autoPlayMedia: null,

        // Global override for preloading lazy-loaded iframes (null/true/false)
        preloadIframes: null,

        // Number of milliseconds between automatically proceeding to the
        // next slide, disabled when set to 0, this value can be overwritten
        // by using a data-autoslide attribute on your slides
        autoSlide: 0,

        // Stop auto-sliding after user input
        autoSlideStoppable: true,

        // Use this method for navigation when auto-sliding
        autoSlideMethod: null,

        // Specify the average time in seconds that you think you will spend
        // presenting each slide. This is used to show a pacing timer in the
        // speaker view
        defaultTiming: null,

        // Enable slide navigation via mouse wheel
        mouseWheel: false,

        // The display mode that will be used to show slides
        display: 'block',

        // Hide cursor if inactive
        hideInactiveCursor: true,

        // Time before the cursor is hidden (in ms)
        hideCursorTime: 5000,

        // Opens links in an iframe preview overlay
        previewLinks: false,

        // Transition style (none/fade/slide/convex/concave/zoom)
        transition: 'none',

        // Transition speed (default/fast/slow)
        transitionSpeed: 'default',

        // Transition style for full page slide backgrounds
        // (none/fade/slide/convex/concave/zoom)
        backgroundTransition: 'none',

        // Number of slides away from the current that are visible
        viewDistance: 3,

        // Number of slides away from the current that are visible on mobile
        // devices. It is advisable to set this to a lower number than
        // viewDistance in order to save resources.
        mobileViewDistance: 2,

        // The "normal" size of the presentation, aspect ratio will be preserved
        // when the presentation is scaled to fit different resolutions. Can be
        // specified using percentage units.
        width: 1050,

        height: 700,

        // Factor of the display size that should remain empty around the content
        margin: 0.1,

        math: {
          mathjax: 'https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/MathJax.js',
          config: 'TeX-AMS_HTML-full',
          tex2jax: {
            inlineMath: [['\\(','\\)']],
            displayMath: [['\\[','\\]']],
            balanceBraces: true,
            processEscapes: false,
            processRefs: true,
            processEnvironments: true,
            preview: 'TeX',
            skipTags: ['script','noscript','style','textarea','pre','code'],
            ignoreClass: 'tex2jax_ignore',
            processClass: 'tex2jax_process'
          },
        },

        // reveal.js plugins
        plugins: [QuartoLineHighlight, PdfExport, RevealMenu, RevealChalkboard, RevealPointer, QuartoSupport,

          RevealMath,
          RevealNotes,
          RevealSearch,
          RevealZoom
        ]
      });
    </script>
    <script id="quarto-html-after-body" type="application/javascript">
      window.document.addEventListener("DOMContentLoaded", function (event) {
        const tabsets =  window.document.querySelectorAll(".panel-tabset-tabby")
        tabsets.forEach(function(tabset) {
          const tabby = new Tabby('#' + tabset.id);
        });
        const isCodeAnnotation = (el) => {
          for (const clz of el.classList) {
            if (clz.startsWith('code-annotation-')) {                     
              return true;
            }
          }
          return false;
        }
        const onCopySuccess = function(e) {
          // button target
          const button = e.trigger;
          // don't keep focus
          button.blur();
          // flash "checked"
          button.classList.add('code-copy-button-checked');
          var currentTitle = button.getAttribute("title");
          button.setAttribute("title", "Copiada");
          let tooltip;
          if (window.bootstrap) {
            button.setAttribute("data-bs-toggle", "tooltip");
            button.setAttribute("data-bs-placement", "left");
            button.setAttribute("data-bs-title", "Copiada");
            tooltip = new bootstrap.Tooltip(button, 
              { trigger: "manual", 
                customClass: "code-copy-button-tooltip",
                offset: [0, -8]});
            tooltip.show();    
          }
          setTimeout(function() {
            if (tooltip) {
              tooltip.hide();
              button.removeAttribute("data-bs-title");
              button.removeAttribute("data-bs-toggle");
              button.removeAttribute("data-bs-placement");
            }
            button.setAttribute("title", currentTitle);
            button.classList.remove('code-copy-button-checked');
          }, 1000);
          // clear code selection
          e.clearSelection();
        }
        const getTextToCopy = function(trigger) {
            const codeEl = trigger.previousElementSibling.cloneNode(true);
            for (const childEl of codeEl.children) {
              if (isCodeAnnotation(childEl)) {
                childEl.remove();
              }
            }
            return codeEl.innerText;
        }
        const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
          text: getTextToCopy
        });
        clipboard.on('success', onCopySuccess);
        if (window.document.getElementById('quarto-embedded-source-code-modal')) {
          const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
            text: getTextToCopy,
            container: window.document.getElementById('quarto-embedded-source-code-modal')
          });
          clipboardModal.on('success', onCopySuccess);
        }
          var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
          var mailtoRegex = new RegExp(/^mailto:/);
            var filterRegex = new RegExp('/' + window.location.host + '/');
          var isInternal = (href) => {
              return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
          }
          // Inspect non-navigation links and adorn them if external
         var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
          for (var i=0; i<links.length; i++) {
            const link = links[i];
            if (!isInternal(link.href)) {
              // undo the damage that might have been done by quarto-nav.js in the case of
              // links that we want to consider external
              if (link.dataset.originalHref !== undefined) {
                link.href = link.dataset.originalHref;
              }
            }
          }
        function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
          const config = {
            allowHTML: true,
            maxWidth: 500,
            delay: 100,
            arrow: false,
            appendTo: function(el) {
                return el.closest('section.slide') || el.parentElement;
            },
            interactive: true,
            interactiveBorder: 10,
            theme: 'light-border',
            placement: 'bottom-start',
          };
          if (contentFn) {
            config.content = contentFn;
          }
          if (onTriggerFn) {
            config.onTrigger = onTriggerFn;
          }
          if (onUntriggerFn) {
            config.onUntrigger = onUntriggerFn;
          }
            config['offset'] = [0,0];
            config['maxWidth'] = 700;
          window.tippy(el, config); 
        }
        const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
        for (var i=0; i<noterefs.length; i++) {
          const ref = noterefs[i];
          tippyHover(ref, function() {
            // use id or data attribute instead here
            let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
            try { href = new URL(href).hash; } catch {}
            const id = href.replace(/^#\/?/, "");
            const note = window.document.getElementById(id);
            if (note) {
              return note.innerHTML;
            } else {
              return "";
            }
          });
        }
        const findCites = (el) => {
          const parentEl = el.parentElement;
          if (parentEl) {
            const cites = parentEl.dataset.cites;
            if (cites) {
              return {
                el,
                cites: cites.split(' ')
              };
            } else {
              return findCites(el.parentElement)
            }
          } else {
            return undefined;
          }
        };
        var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
        for (var i=0; i<bibliorefs.length; i++) {
          const ref = bibliorefs[i];
          const citeInfo = findCites(ref);
          if (citeInfo) {
            tippyHover(citeInfo.el, function() {
              var popup = window.document.createElement('div');
              citeInfo.cites.forEach(function(cite) {
                var citeDiv = window.document.createElement('div');
                citeDiv.classList.add('hanging-indent');
                citeDiv.classList.add('csl-entry');
                var biblioDiv = window.document.getElementById('ref-' + cite);
                if (biblioDiv) {
                  citeDiv.innerHTML = biblioDiv.innerHTML;
                }
                popup.appendChild(citeDiv);
              });
              return popup.innerHTML;
            });
          }
        }
      });
      </script>
    

</body></html>